Return-Path: <owner-linux-mm@kvack.org>
Received: from mail-pd0-f179.google.com (mail-pd0-f179.google.com [209.85.192.179])
	by kanga.kvack.org (Postfix) with ESMTP id E91D56B0032
	for <linux-mm@kvack.org>; Tue, 31 Mar 2015 03:36:58 -0400 (EDT)
Received: by pddn5 with SMTP id n5so12222210pdd.2
        for <linux-mm@kvack.org>; Tue, 31 Mar 2015 00:36:58 -0700 (PDT)
Received: from mail.sfc.wide.ad.jp (shonan.sfc.wide.ad.jp. [203.178.142.130])
        by mx.google.com with ESMTPS id aj10si18178905pbd.206.2015.03.31.00.36.57
        for <linux-mm@kvack.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 31 Mar 2015 00:36:57 -0700 (PDT)
Date: Tue, 31 Mar 2015 16:36:55 +0900
Message-ID: <m2zj6t7h48.wl@wide.ad.jp>
From: Hajime Tazaki<tazaki@wide.ad.jp>
Subject: Re: [RFC PATCH 08/11] lib: other kernel glue layer code
In-Reply-To: <5518419E.8010007@nod.at>
References: <1427202642-1716-1-git-send-email-tazaki@sfc.wide.ad.jp>
	<1427202642-1716-9-git-send-email-tazaki@sfc.wide.ad.jp>
	<5518419E.8010007@nod.at>
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: richard@nod.at
Cc: linux-arch@vger.kernel.org, arnd@arndb.de, corbet@lwn.net, cl@linux.com, penberg@kernel.org, rientjes@google.com, iamjoonsoo.kim@lge.com, akpm@linux-foundation.org, linux-kernel@vger.kernel.org, linux-doc@vger.kernel.org, netdev@vger.kernel.org, linux-mm@kvack.org, jdike@addtoit.com, rusty@rustcorp.com.au, mathieu.lacage@gmail.com, christoph.paasch@gmail.com


Hi Richard,

thanks again.

At Sun, 29 Mar 2015 20:17:02 +0200,
Richard Weinberger wrote:
> 
> Am 24.03.2015 um 14:10 schrieb Hajime Tazaki:
> > These files are used to provide the same function calls so that other
> > network stack code keeps untouched.
> > 
> > Signed-off-by: Hajime Tazaki <tazaki@sfc.wide.ad.jp>
> > Signed-off-by: Christoph Paasch <christoph.paasch@gmail.com>
> > ---
> >  arch/lib/cred.c     |  16 +++
> >  arch/lib/dcache.c   |  93 +++++++++++++++
> >  arch/lib/filemap.c  |  27 +++++
> >  arch/lib/fs.c       | 287 ++++++++++++++++++++++++++++++++++++++++++++
> >  arch/lib/glue.c     | 336 ++++++++++++++++++++++++++++++++++++++++++++++++++++
> >  arch/lib/inode.c    | 146 +++++++++++++++++++++++
> >  arch/lib/modules.c  |  36 ++++++
> >  arch/lib/pid.c      |  29 +++++
> >  arch/lib/print.c    |  56 +++++++++
> >  arch/lib/proc.c     | 164 +++++++++++++++++++++++++
> >  arch/lib/random.c   |  53 +++++++++
> >  arch/lib/security.c |  45 +++++++
> >  arch/lib/seq.c      | 122 +++++++++++++++++++
> >  arch/lib/splice.c   |  20 ++++
> >  arch/lib/super.c    | 210 ++++++++++++++++++++++++++++++++
> >  arch/lib/sysfs.c    |  83 +++++++++++++
> >  arch/lib/vmscan.c   |  26 ++++
> >  17 files changed, 1749 insertions(+)
> 
> BTW: Why do you need these stub implementations at all?
> If I read your code correctly it is because you're linking against the whole net/ directory.
> Let's take register_filesystem() again as example. net/socket.c references it in sock_init().
> Maybe it would make sense to split socket.c into two files, net/socket.c and net/sockfs.c.
> Such that you could link only net/socket.o.
> Of course you'd have to convince networking folks first. :D

this is something that we've been avoided: we weren't able
to estimate how much such splits will expand.

> By linking selectively objects files from net/ you could get rid of a lot unneeded stubs.

now I'm trying to minimize those stubs by reusing the original
codes (i.e., fs/filesystems.c for register_filesystem()). I
will let you know once I've done (maybe v2 RFC if you think
it's better ?)

-- Hajime

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
