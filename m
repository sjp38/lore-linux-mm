Return-Path: <owner-linux-mm@kvack.org>
Received: from mail-pa0-f72.google.com (mail-pa0-f72.google.com [209.85.220.72])
	by kanga.kvack.org (Postfix) with ESMTP id 481156B028B
	for <linux-mm@kvack.org>; Fri, 23 Sep 2016 16:16:29 -0400 (EDT)
Received: by mail-pa0-f72.google.com with SMTP id mi5so221472865pab.2
        for <linux-mm@kvack.org>; Fri, 23 Sep 2016 13:16:29 -0700 (PDT)
Received: from NAM03-CO1-obe.outbound.protection.outlook.com (mail-co1nam03on0104.outbound.protection.outlook.com. [104.47.40.104])
        by mx.google.com with ESMTPS id h124si9320464pfg.215.2016.09.23.13.16.28
        for <linux-mm@kvack.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
        Fri, 23 Sep 2016 13:16:28 -0700 (PDT)
From: Matthew Wilcox <mawilcox@microsoft.com>
Subject: RE: [PATCH 2/2] radix-tree: Fix optimisation problem
Date: Fri, 23 Sep 2016 20:16:26 +0000
Message-ID: <DM2PR21MB0089CA7DCF4845DB02E0E05FCBC80@DM2PR21MB0089.namprd21.prod.outlook.com>
References: <1474570415-14938-1-git-send-email-mawilcox@linuxonhyperv.com>
 <1474570415-14938-3-git-send-email-mawilcox@linuxonhyperv.com>
 <CA+55aFwNYAFc4KePvx50kwZ3A+8yvCCK_6nYYxG9fqTPhFzQoQ@mail.gmail.com>
In-Reply-To: <CA+55aFwNYAFc4KePvx50kwZ3A+8yvCCK_6nYYxG9fqTPhFzQoQ@mail.gmail.com>
Content-Language: en-US
Content-Type: multipart/mixed;
	boundary="_002_DM2PR21MB0089CA7DCF4845DB02E0E05FCBC80DM2PR21MB0089namp_"
MIME-Version: 1.0
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: Linus Torvalds <torvalds@linux-foundation.org>, Matthew Wilcox <mawilcox@linuxonhyperv.com>
Cc: "Kirill A. Shutemov" <kirill.shutemov@linux.intel.com>, Andrew Morton <akpm@linux-foundation.org>, Konstantin Khlebnikov <koct9i@gmail.com>, Ross
 Zwisler <ross.zwisler@linux.intel.com>, Linux Kernel Mailing List <linux-kernel@vger.kernel.org>, linux-mm <linux-mm@kvack.org>, linux-fsdevel <linux-fsdevel@vger.kernel.org>

--_002_DM2PR21MB0089CA7DCF4845DB02E0E05FCBC80DM2PR21MB0089namp_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

RnJvbTogbGludXM5NzFAZ21haWwuY29tIFttYWlsdG86bGludXM5NzFAZ21haWwuY29tXSBPbiBC
ZWhhbGYgT2YgTGludXMgVG9ydmFsZHMNCj4gT24gVGh1LCBTZXAgMjIsIDIwMTYgYXQgMTE6NTMg
QU0sIE1hdHRoZXcgV2lsY294DQo+IDxtYXdpbGNveEBsaW51eG9uaHlwZXJ2LmNvbT4gd3JvdGU6
DQo+ID4NCj4gPiAgICAgICAgICAgQ2hhbmdlIHRoZSB0ZXN0IHN1aXRlIHRvIGNvbXBpbGUgd2l0
aCAtTzIsIGFuZA0KPiA+IGZpeCB0aGUgb3B0aW1pc2F0aW9uIHByb2JsZW0gYnkgcGFzc2luZyAn
ZW50cnknIHRocm91Z2ggZW50cnlfdG9fbm9kZSgpDQo+ID4gc28gZ2NjIGtub3dzIHRoaXMgaXNu
J3QgYSBwbGFpbiBwb2ludGVyLg0KPiANCj4gVWdoLiBJIHJlYWxseSBkb24ndCBsaWtlIHRoaXMg
cGF0Y2ggdmVyeSBtdWNoLg0KPiANCj4gV291bGRuJ3QgaXQgYmUgY2xlYW5lciB0byBqdXN0IGZp
eCAiZ2V0X3Nsb3Rfb2Zmc2V0KCkiIGluc3RlYWQ/IEFzIGl0DQo+IGlzLCBsb29raW5nIGF0IHRo
ZSBjb2RlLCBJIHN1c3BlY3QgdGhhdCBpdCdzIHJlYWxseSBoYXJkIHRvIGNvbnZpbmNlDQo+IHBl
b3BsZSB0aGF0IHRoZXJlIGlzbid0IHNvbWUgb3RoZXIgcGxhY2UgdGhpcyBtaWdodCBoYXBwZW4u
IEJlY2F1c2UNCj4gdGhlICJwb2ludGVyIHN1YnRyYWN0aW9uIGZvbGxvd2VkIGJ5IHBvaW50ZXIg
YWRkaXRpb24iIHBhdHRlcm4gaXMgYWxsDQo+IGhpZGRlbiBpbiB0aGVzZSBpbmxpbmUgZnVuY3Rp
b25zLg0KPiANCj4gT3IgYXQgbGVhc3QgYWRkIGEgYmlnIGNvbW1lbnQgYWJvdXQgd2h5IHRoaXMg
aXMgdGhlIG9ubHkgc3VjaCBjYXNlLg0KPiANCj4gQmVjYXVzZSB3aXRob3V0IHRoYXQsIHRoZSBj
b2RlIG5vdyBsb29rcyB2ZXJ5IGJhZC4NCg0KVGhhdCdzIGZhaXIuICBJIGxvb2tlZCBhdCBhbGwg
dGhlIG90aGVyIGNhbGxlcnMgb2YgZ2V0X3Nsb3Rfb2Zmc2V0LCBhbmQgYWxsIHRoZSBvdGhlcnMg
YXJlIHVzaW5nIGEgcmVhbCBzbG90IHBvaW50ZXIuICByYWRpeF90cmVlX2Rlc2NlbmQoKSByZWFs
bHkgaXMgdGhlIG91dGxpZXIgaGVyZS4gIEkgdGhpbmsgdGhlIHJlYWwgcHJvYmxlbSBpcyB0aGF0
IHRoZSB0eXBlcyBpbiB0aGUgdHJlZSBhcmUgd3Jvbmc7IGluc3RlYWQgb2Ygc3RvcmluZyB2b2lk
ICosIHdlIHNob3VsZCBiZSBzdG9yaW5nIHVpbnRwdHJfdC4gIEJ1dCBmaXhpbmcgdGhhdCBpcyBh
IGxpdHRsZSBiZXlvbmQgdGhlIHNjb3BlIG9mIC1yYzguICBIZXJlJ3MgYSBzbGlnaHRseSBiZXR0
ZXIgdmVyc2lvbiB3aGljaCBhc3NlcnRzIHRoYXQgdGhlIHBhc3NlZCBwb2ludGVyIHJlYWxseSBp
cyBhIHBvaW50ZXIuDQoNCihhdHRhY2hlZCBhcyB3ZWxsLCBJIGhhdmUgbm8gaWRlYSB3aGV0aGVy
IHRoaXMgcGF0Y2ggd2lsbCBnZXQgbWFuZ2xlZCkNCg0KZGlmZiAtLWdpdCBhL2xpYi9yYWRpeC10
cmVlLmMgYi9saWIvcmFkaXgtdHJlZS5jDQppbmRleCAxYjdiZjczLi4zNjhmNjQxIDEwMDY0NA0K
LS0tIGEvbGliL3JhZGl4LXRyZWUuYw0KKysrIGIvbGliL3JhZGl4LXRyZWUuYw0KQEAgLTkxLDkg
KzkxLDE1IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBpc19zaWJsaW5nX2VudHJ5KHN0cnVjdCByYWRp
eF90cmVlX25vZGUgKnBhcmVudCwgdm9pZCAqbm9kZSkNCiB9DQogI2VuZGlmDQogDQorLyoNCisg
KiBUaGUgc2xvdCBwb2ludGVyIG11c3QgYmUgYSByZWFsIHBvaW50ZXIgYXMgR0NDIHdpbGwgb3B0
aW1pc2UNCisgKiB0aHJvdWdoIGlubGluZWQgZnVuY3Rpb25zIGFuZCBtYXkgZGVkdWNlIHRoYXQN
CisgKiBwYXJlbnQtPnNsb3RzICsgZ2V0X3Nsb3Rfb2Zmc2V0KHBhcmVudCwgc2xvdCkgPT0gc2xv
dA0KKyAqLw0KIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBnZXRfc2xvdF9vZmZzZXQoc3Ry
dWN0IHJhZGl4X3RyZWVfbm9kZSAqcGFyZW50LA0KIAkJCQkJCSB2b2lkICoqc2xvdCkNCiB7DQor
CUJVR19PTihyYWRpeF90cmVlX2V4Y2VwdGlvbihzbG90KSk7DQogCXJldHVybiBzbG90IC0gcGFy
ZW50LT5zbG90czsNCiB9DQogDQpAQCAtMTAxLDExICsxMDcsMTIgQEAgc3RhdGljIHVuc2lnbmVk
IGludCByYWRpeF90cmVlX2Rlc2NlbmQoc3RydWN0IHJhZGl4X3RyZWVfbm9kZSAqcGFyZW50LA0K
IAkJCXN0cnVjdCByYWRpeF90cmVlX25vZGUgKipub2RlcCwgdW5zaWduZWQgbG9uZyBpbmRleCkN
CiB7DQogCXVuc2lnbmVkIGludCBvZmZzZXQgPSAoaW5kZXggPj4gcGFyZW50LT5zaGlmdCkgJiBS
QURJWF9UUkVFX01BUF9NQVNLOw0KLQl2b2lkICoqZW50cnkgPSByY3VfZGVyZWZlcmVuY2VfcmF3
KHBhcmVudC0+c2xvdHNbb2Zmc2V0XSk7DQorCXZvaWQgKmVudHJ5ID0gcmN1X2RlcmVmZXJlbmNl
X3JhdyhwYXJlbnQtPnNsb3RzW29mZnNldF0pOw0KIA0KICNpZmRlZiBDT05GSUdfUkFESVhfVFJF
RV9NVUxUSU9SREVSDQogCWlmIChyYWRpeF90cmVlX2lzX2ludGVybmFsX25vZGUoZW50cnkpKSB7
DQotCQl1bnNpZ25lZCBsb25nIHNpYm9mZiA9IGdldF9zbG90X29mZnNldChwYXJlbnQsIGVudHJ5
KTsNCisJCXVuc2lnbmVkIGxvbmcgc2lib2ZmID0gZ2V0X3Nsb3Rfb2Zmc2V0KHBhcmVudCwNCisJ
CQkJCQkodm9pZCAqKillbnRyeV90b19ub2RlKGVudHJ5KSk7DQogCQlpZiAoc2lib2ZmIDwgUkFE
SVhfVFJFRV9NQVBfU0laRSkgew0KIAkJCW9mZnNldCA9IHNpYm9mZjsNCiAJCQllbnRyeSA9IHJj
dV9kZXJlZmVyZW5jZV9yYXcocGFyZW50LT5zbG90c1tvZmZzZXRdKTsNCkBAIC0xMTMsNyArMTIw
LDcgQEAgc3RhdGljIHVuc2lnbmVkIGludCByYWRpeF90cmVlX2Rlc2NlbmQoc3RydWN0IHJhZGl4
X3RyZWVfbm9kZSAqcGFyZW50LA0KIAl9DQogI2VuZGlmDQogDQotCSpub2RlcCA9ICh2b2lkICop
ZW50cnk7DQorCSpub2RlcCA9IGVudHJ5Ow0KIAlyZXR1cm4gb2Zmc2V0Ow0KIH0NCiANCmRpZmYg
LS1naXQgYS90b29scy90ZXN0aW5nL3JhZGl4LXRyZWUvTWFrZWZpbGUgYi90b29scy90ZXN0aW5n
L3JhZGl4LXRyZWUvTWFrZWZpbGUNCmluZGV4IDNiNTMwNDYuLjlkMDkxOWVkIDEwMDY0NA0KLS0t
IGEvdG9vbHMvdGVzdGluZy9yYWRpeC10cmVlL01ha2VmaWxlDQorKysgYi90b29scy90ZXN0aW5n
L3JhZGl4LXRyZWUvTWFrZWZpbGUNCkBAIC0xLDUgKzEsNSBAQA0KIA0KLUNGTEFHUyArPSAtSS4g
LWcgLVdhbGwgLURfTEdQTF9TT1VSQ0UNCitDRkxBR1MgKz0gLUkuIC1nIC1PMiAtV2FsbCAtRF9M
R1BMX1NPVVJDRQ0KIExERkxBR1MgKz0gLWxwdGhyZWFkIC1sdXJjdQ0KIFRBUkdFVFMgPSBtYWlu
DQogT0ZJTEVTID0gbWFpbi5vIHJhZGl4LXRyZWUubyBsaW51eC5vIHRlc3QubyB0YWdfY2hlY2su
byBmaW5kX25leHRfYml0Lm8gXA0K

--_002_DM2PR21MB0089CA7DCF4845DB02E0E05FCBC80DM2PR21MB0089namp_
Content-Type: application/octet-stream; name="for-linus.diff"
Content-Description: for-linus.diff
Content-Disposition: attachment; filename="for-linus.diff"; size=1871;
	creation-date="Fri, 23 Sep 2016 20:09:17 GMT";
	modification-date="Fri, 23 Sep 2016 20:09:17 GMT"
Content-Transfer-Encoding: base64

ZGlmZiAtLWdpdCBhL2xpYi9yYWRpeC10cmVlLmMgYi9saWIvcmFkaXgtdHJlZS5jCmluZGV4IDFi
N2JmNzMuLjM2OGY2NDEgMTAwNjQ0Ci0tLSBhL2xpYi9yYWRpeC10cmVlLmMKKysrIGIvbGliL3Jh
ZGl4LXRyZWUuYwpAQCAtOTEsOSArOTEsMTUgQEAgc3RhdGljIGlubGluZSBib29sIGlzX3NpYmxp
bmdfZW50cnkoc3RydWN0IHJhZGl4X3RyZWVfbm9kZSAqcGFyZW50LCB2b2lkICpub2RlKQogfQog
I2VuZGlmCiAKKy8qCisgKiBUaGUgc2xvdCBwb2ludGVyIG11c3QgYmUgYSByZWFsIHBvaW50ZXIg
YXMgR0NDIHdpbGwgb3B0aW1pc2UKKyAqIHRocm91Z2ggaW5saW5lZCBmdW5jdGlvbnMgYW5kIG1h
eSBkZWR1Y2UgdGhhdAorICogcGFyZW50LT5zbG90cyArIGdldF9zbG90X29mZnNldChwYXJlbnQs
IHNsb3QpID09IHNsb3QKKyAqLwogc3RhdGljIGlubGluZSB1bnNpZ25lZCBsb25nIGdldF9zbG90
X29mZnNldChzdHJ1Y3QgcmFkaXhfdHJlZV9ub2RlICpwYXJlbnQsCiAJCQkJCQkgdm9pZCAqKnNs
b3QpCiB7CisJQlVHX09OKHJhZGl4X3RyZWVfZXhjZXB0aW9uKHNsb3QpKTsKIAlyZXR1cm4gc2xv
dCAtIHBhcmVudC0+c2xvdHM7CiB9CiAKQEAgLTEwMSwxMSArMTA3LDEyIEBAIHN0YXRpYyB1bnNp
Z25lZCBpbnQgcmFkaXhfdHJlZV9kZXNjZW5kKHN0cnVjdCByYWRpeF90cmVlX25vZGUgKnBhcmVu
dCwKIAkJCXN0cnVjdCByYWRpeF90cmVlX25vZGUgKipub2RlcCwgdW5zaWduZWQgbG9uZyBpbmRl
eCkKIHsKIAl1bnNpZ25lZCBpbnQgb2Zmc2V0ID0gKGluZGV4ID4+IHBhcmVudC0+c2hpZnQpICYg
UkFESVhfVFJFRV9NQVBfTUFTSzsKLQl2b2lkICoqZW50cnkgPSByY3VfZGVyZWZlcmVuY2VfcmF3
KHBhcmVudC0+c2xvdHNbb2Zmc2V0XSk7CisJdm9pZCAqZW50cnkgPSByY3VfZGVyZWZlcmVuY2Vf
cmF3KHBhcmVudC0+c2xvdHNbb2Zmc2V0XSk7CiAKICNpZmRlZiBDT05GSUdfUkFESVhfVFJFRV9N
VUxUSU9SREVSCiAJaWYgKHJhZGl4X3RyZWVfaXNfaW50ZXJuYWxfbm9kZShlbnRyeSkpIHsKLQkJ
dW5zaWduZWQgbG9uZyBzaWJvZmYgPSBnZXRfc2xvdF9vZmZzZXQocGFyZW50LCBlbnRyeSk7CisJ
CXVuc2lnbmVkIGxvbmcgc2lib2ZmID0gZ2V0X3Nsb3Rfb2Zmc2V0KHBhcmVudCwKKwkJCQkJCSh2
b2lkICoqKWVudHJ5X3RvX25vZGUoZW50cnkpKTsKIAkJaWYgKHNpYm9mZiA8IFJBRElYX1RSRUVf
TUFQX1NJWkUpIHsKIAkJCW9mZnNldCA9IHNpYm9mZjsKIAkJCWVudHJ5ID0gcmN1X2RlcmVmZXJl
bmNlX3JhdyhwYXJlbnQtPnNsb3RzW29mZnNldF0pOwpAQCAtMTEzLDcgKzEyMCw3IEBAIHN0YXRp
YyB1bnNpZ25lZCBpbnQgcmFkaXhfdHJlZV9kZXNjZW5kKHN0cnVjdCByYWRpeF90cmVlX25vZGUg
KnBhcmVudCwKIAl9CiAjZW5kaWYKIAotCSpub2RlcCA9ICh2b2lkICopZW50cnk7CisJKm5vZGVw
ID0gZW50cnk7CiAJcmV0dXJuIG9mZnNldDsKIH0KIApkaWZmIC0tZ2l0IGEvdG9vbHMvdGVzdGlu
Zy9yYWRpeC10cmVlL01ha2VmaWxlIGIvdG9vbHMvdGVzdGluZy9yYWRpeC10cmVlL01ha2VmaWxl
CmluZGV4IDNiNTMwNDYuLjlkMDkxOWVkIDEwMDY0NAotLS0gYS90b29scy90ZXN0aW5nL3JhZGl4
LXRyZWUvTWFrZWZpbGUKKysrIGIvdG9vbHMvdGVzdGluZy9yYWRpeC10cmVlL01ha2VmaWxlCkBA
IC0xLDUgKzEsNSBAQAogCi1DRkxBR1MgKz0gLUkuIC1nIC1XYWxsIC1EX0xHUExfU09VUkNFCitD
RkxBR1MgKz0gLUkuIC1nIC1PMiAtV2FsbCAtRF9MR1BMX1NPVVJDRQogTERGTEFHUyArPSAtbHB0
aHJlYWQgLWx1cmN1CiBUQVJHRVRTID0gbWFpbgogT0ZJTEVTID0gbWFpbi5vIHJhZGl4LXRyZWUu
byBsaW51eC5vIHRlc3QubyB0YWdfY2hlY2subyBmaW5kX25leHRfYml0Lm8gXAo=

--_002_DM2PR21MB0089CA7DCF4845DB02E0E05FCBC80DM2PR21MB0089namp_--

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
