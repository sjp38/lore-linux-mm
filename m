Return-Path: <owner-linux-mm@kvack.org>
Received: from mail144.messagelabs.com (mail144.messagelabs.com [216.82.254.51])
	by kanga.kvack.org (Postfix) with SMTP id 69E626B0055
	for <linux-mm@kvack.org>; Sat, 26 Sep 2009 21:40:45 -0400 (EDT)
Received: by gxk19 with SMTP id 19so4429581gxk.10
        for <linux-mm@kvack.org>; Sat, 26 Sep 2009 18:36:51 -0700 (PDT)
Message-ID: <4ABEC1AE.2060202@gmail.com>
Date: Sun, 27 Sep 2009 09:36:46 +0800
From: Huang Shijie <shijie8@gmail.com>
MIME-Version: 1.0
Subject: Re: [PATCH] swap : remove unused field of swapper_space
References: <1253869953-4747-1-git-send-email-shijie8@gmail.com> <Pine.LNX.4.64.0909251207440.7106@sister.anvils>
In-Reply-To: <Pine.LNX.4.64.0909251207440.7106@sister.anvils>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
Sender: owner-linux-mm@kvack.org
To: Hugh Dickins <hugh.dickins@tiscali.co.uk>
Cc: akpm@linux-foundation.org, linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>

Hugh Dickins a??e??:
> On Fri, 25 Sep 2009, Huang Shijie wrote:
>
>   
>> There is no place to use the i_mmap_nonlinear of swapper_space, so
>> remove it.
>>
>> Signed-off-by: Huang Shijie <shijie8@gmail.com>
>>     
>
> I say NAK, unless you're very sure:
> see commit comment below when I added that line.
>
> Hugh
>
>   
>> ---
>>  mm/swap_state.c |    1 -
>>  1 files changed, 0 insertions(+), 1 deletions(-)
>>
>> diff --git a/mm/swap_state.c b/mm/swap_state.c
>> index 6d1daeb..be16a6b 100644
>> --- a/mm/swap_state.c
>> +++ b/mm/swap_state.c
>> @@ -43,7 +43,6 @@ struct address_space swapper_space = {
>>  	.page_tree	= RADIX_TREE_INIT(GFP_ATOMIC|__GFP_NOWARN),
>>  	.tree_lock	= __SPIN_LOCK_UNLOCKED(swapper_space.tree_lock),
>>  	.a_ops		= &swap_aops,
>> -	.i_mmap_nonlinear = LIST_HEAD_INIT(swapper_space.i_mmap_nonlinear),
>>  	.backing_dev_info = &swap_backing_dev_info,
>>  };
>>  
>>     
>
> commit e11f2cc49856eabafed09cf30e190646f78b7207
> Author: Hugh Dickins <hugh@veritas.com>
> Date:   Fri Jun 4 20:51:55 2004 -0700
>
>     [PATCH] mm: swapper_space.i_mmap_nonlinear
>     
>     Initialize swapper_space.i_mmap_nonlinear, so mapping_mapped reports false on
>     it (as it used to do).  Update comment on swapper_space, now more fields are
>     used than those initialized explicitly.
>     
>     Signed-off-by: Hugh Dickins <hugh@veritas.com>
>     Signed-off-by: Andrew Morton <akpm@osdl.org>
>     Signed-off-by: Linus Torvalds <torvalds@osdl.org>
>
>   
Yes ,you are right.

I didn't notice that there were other places calling mapping_mapped() in 
non-x86 archs.
The result generated by the default "make cscope" fooled me.

thanks.


--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
