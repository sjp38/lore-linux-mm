Return-Path: <owner-linux-mm@kvack.org>
Received: from mail-lb0-f175.google.com (mail-lb0-f175.google.com [209.85.217.175])
	by kanga.kvack.org (Postfix) with ESMTP id 71E536B0031
	for <linux-mm@kvack.org>; Tue,  3 Dec 2013 04:44:43 -0500 (EST)
Received: by mail-lb0-f175.google.com with SMTP id x18so8765313lbi.34
        for <linux-mm@kvack.org>; Tue, 03 Dec 2013 01:44:42 -0800 (PST)
Received: from relay.parallels.com (relay.parallels.com. [195.214.232.42])
        by mx.google.com with ESMTPS id 6si21095789lby.82.2013.12.03.01.44.41
        for <linux-mm@kvack.org>
        (version=TLSv1 cipher=RC4-SHA bits=128/128);
        Tue, 03 Dec 2013 01:44:42 -0800 (PST)
Message-ID: <529DA806.5010307@parallels.com>
Date: Tue, 3 Dec 2013 13:44:38 +0400
From: Vladimir Davydov <vdavydov@parallels.com>
MIME-Version: 1.0
Subject: Re: [PATCH v12 06/18] vmscan: rename shrink_slab() args to make it
 more generic
References: <cover.1385974612.git.vdavydov@parallels.com> <6fbe648a707331e0716cc7a4fc6366ca83a97f6a.1385974612.git.vdavydov@parallels.com> <20131203093323.GC8803@dastard>
In-Reply-To: <20131203093323.GC8803@dastard>
Content-Type: text/plain; charset="ISO-8859-1"
Content-Transfer-Encoding: 7bit
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: Dave Chinner <david@fromorbit.com>
Cc: hannes@cmpxchg.org, mhocko@suse.cz, dchinner@redhat.com, akpm@linux-foundation.org, linux-kernel@vger.kernel.org, linux-mm@kvack.org, cgroups@vger.kernel.org, devel@openvz.org, glommer@openvz.org, Mel Gorman <mgorman@suse.de>, Rik van Riel <riel@redhat.com>

On 12/03/2013 01:33 PM, Dave Chinner wrote:
>> kmemcg reclaim is introduced, we will have to make up phony values for
>> nr_pages_scanned and lru_pages again when doing kmem-only reclaim for a
>> memory cgroup, which is possible if the cgroup has its kmem limit less
>> than the total memory limit.
> I'm missing something here - why would memcg reclaim require
> passing phony values? How are you going to keep slab caches in
> balance with memory pressure generated by the page cache?

To perform kmem-only reclaim - please see patch 13. When the kmem limit
is less than the user limit, we can reach only the kmem limit. It is no
use trying to reclaim page cache then.

On normal reclaim - I mean try_to_free_mem_cgroup_pages() - I pass
nr_scanned/lru_pages to shrink_slab() as usual.

Thanks.

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
