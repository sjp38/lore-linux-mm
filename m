Return-Path: <owner-linux-mm@kvack.org>
Received: from mail-ob0-f198.google.com (mail-ob0-f198.google.com [209.85.214.198])
	by kanga.kvack.org (Postfix) with ESMTP id E5D616B0253
	for <linux-mm@kvack.org>; Mon, 27 Jun 2016 01:14:38 -0400 (EDT)
Received: by mail-ob0-f198.google.com with SMTP id at7so311028738obd.1
        for <linux-mm@kvack.org>; Sun, 26 Jun 2016 22:14:38 -0700 (PDT)
Received: from mail2.asahi-net.or.jp (mail2.asahi-net.or.jp. [202.224.39.198])
        by mx.google.com with ESMTP id l81si12023414iod.102.2016.06.26.22.14.37
        for <linux-mm@kvack.org>;
        Sun, 26 Jun 2016 22:14:37 -0700 (PDT)
Date: Mon, 27 Jun 2016 14:14:36 +0900
Message-ID: <87ziq7z003.wl-ysato@users.sourceforge.jp>
From: Yoshinori Sato <ysato@users.sourceforge.jp>
Subject: Re: undefined reference to `printk'
In-Reply-To: <201606260947.7y4PB5Dc%fengguang.wu@intel.com>
References: <201606260947.7y4PB5Dc%fengguang.wu@intel.com>
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: linux-kernel@vger.kernel.org, Josh Triplett <josh@joshtriplett.org>, Andrew Morton <akpm@linux-foundation.org>
Cc: kbuild-all@01.org, Linux Memory Management List <linux-mm@kvack.org>

I think fix it.
default_eit_handler rewritten in C, it is best way.
But it test difficult.

Signed-off-by: Yoshinori Sato <ysato@users.sourceforge.jp>
---
 arch/m32r/kernel/entry.S | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/arch/m32r/kernel/entry.S b/arch/m32r/kernel/entry.S
index c639bfa..a71105c 100644
--- a/arch/m32r/kernel/entry.S
+++ b/arch/m32r/kernel/entry.S
@@ -419,6 +419,12 @@ ENTRY(default_eit_handler)
 infinit:
 	bra	infinit
 
+#ifndef CONFIG_PRINTK
+printk:
+	jmp	lr
+	.fillinsn
+#endif
+
 #ifdef CONFIG_ MMU
 /*
  * Access Exception handler
2.7.0

On Sun, 26 Jun 2016 10:19:50 +0900,
kbuild test robot wrote:
> 
> Hi,
> 
> FYI, the error/warning still remains.
> 
> tree:   https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git master
> head:   da2f6aba4a21f8da3331e5251a117c52764da579
> commit: 5d2acfc7b974bbd3858b4dd3f2cdc6362dd8843a kconfig: make allnoconfig disable options behind EMBEDDED and EXPERT
> date:   2 years, 3 months ago
> config: m32r-allnoconfig (attached as .config)
> compiler: m32r-linux-gcc (GCC) 4.9.0
> reproduce:
>         wget https://git.kernel.org/cgit/linux/kernel/git/wfg/lkp-tests.git/plain/sbin/make.cross -O ~/bin/make.cross
>         chmod +x ~/bin/make.cross
>         git checkout 5d2acfc7b974bbd3858b4dd3f2cdc6362dd8843a
>         # save the attached .config to linux build tree
>         make.cross ARCH=m32r 
> 
> All errors (new ones prefixed by >>):
> 
>    arch/m32r/kernel/built-in.o: In function `default_eit_handler':
> >> (.text+0x3f8): undefined reference to `printk'
>    arch/m32r/kernel/built-in.o: In function `default_eit_handler':
>    (.text+0x3f8): relocation truncated to fit: R_M32R_26_PCREL_RELA against undefined symbol `printk'
> 
> ---
> 0-DAY kernel test infrastructure                Open Source Technology Center
> https://lists.01.org/pipermail/kbuild-all                   Intel Corporation

-- 
Yoshinori Sato
<ysato@users.sourceforge.jp>

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
