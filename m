Return-Path: <owner-linux-mm@kvack.org>
Received: from mail190.messagelabs.com (mail190.messagelabs.com [216.82.249.51])
	by kanga.kvack.org (Postfix) with SMTP id D14C26B00AF
	for <linux-mm@kvack.org>; Mon, 23 Feb 2009 09:46:39 -0500 (EST)
From: Nick Piggin <nickpiggin@yahoo.com.au>
Subject: Re: [RFC PATCH 00/20] Cleanup and optimise the page allocator
Date: Tue, 24 Feb 2009 01:46:01 +1100
References: <1235344649-18265-1-git-send-email-mel@csn.ul.ie>
In-Reply-To: <1235344649-18265-1-git-send-email-mel@csn.ul.ie>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: base64
Content-Disposition: inline
Message-Id: <200902240146.03456.nickpiggin@yahoo.com.au>
Sender: owner-linux-mm@kvack.org
To: Mel Gorman <mel@csn.ul.ie>
Cc: Linux Memory Management List <linux-mm@kvack.org>, Pekka Enberg <penberg@cs.helsinki.fi>, Rik van Riel <riel@redhat.com>, KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com>, Christoph Lameter <cl@linux-foundation.org>, Johannes Weiner <hannes@cmpxchg.org>, Nick Piggin <npiggin@suse.de>, Linux Kernel Mailing List <linux-kernel@vger.kernel.org>, Lin Ming <ming.m.lin@intel.com>, Zhang Yanmin <yanmin_zhang@linux.intel.com>
List-ID: <linux-mm.kvack.org>

SGkgTWVsLAoKU2VlbXMgbGlrZSBhIG5pY2UgcGF0Y2hzZXQuCgpPbiBNb25kYXkgMjMgRmVicnVh
cnkgMjAwOSAxMDoxNzowOSBNZWwgR29ybWFuIHdyb3RlOgo+IFRoZSBjb21wbGV4aXR5IG9mIHRo
ZSBwYWdlIGFsbG9jYXRvciBoYXMgYmVlbiBpbmNyZWFzaW5nIGZvciBzb21lIHRpbWUKPiBhbmQg
aXQgaGFzIG5vdyByZWFjaGVkIHRoZSBwb2ludCB3aGVyZSB0aGUgU0xVQiBhbGxvY2F0b3IgaXMg
ZG9pbmcgc3RyYW5nZQo+IHRyaWNrcyB0byBhdm9pZCB0aGUgcGFnZSBhbGxvY2F0b3IuIFRoaXMg
aXMgb2J2aW91c2x5IGJhZCBhcyBpdCBtYXkKPiBlbmNvdXJhZ2Ugb3RoZXIgc3Vic3lzdGVtcyB0
byB0cnkgYXZvaWRpbmcgdGhlIHBhZ2UgYWxsb2NhdG9yIGFzIHdlbGwuCj4KPiBUaGlzIHNlcmll
cyBvZiBwYXRjaGVzIGlzIGludGVuZGVkIHRvIHJlZHVjZSB0aGUgY29zdCBvZiB0aGUgcGFnZQo+
IGFsbG9jYXRvciBieSBkb2luZyB0aGUgZm9sbG93aW5nLgo+Cj4gUGF0Y2hlcyAxLTMgaXJvbiBv
dXQgdGhlIGVudHJ5IHBhdGhzIHNsaWdodGx5IGFuZCByZW1vdmUgc3R1cGlkIHNhbml0eQo+IGNo
ZWNrcyBmcm9tIHRoZSBmYXN0IHBhdGguCj4KPiBQYXRjaCA0IHVzZXMgYSBsb29rdXAgdGFibGUg
aW5zdGVhZCBvZiBhIG51bWJlciBvZiBicmFuY2hlcyB0byBkZWNpZGUgd2hhdAo+IHpvbmVzIGFy
ZSB1c2FibGUgZ2l2ZW4gdGhlIEdGUCBmbGFncy4KPgo+IFBhdGNoIDUgYXZvaWRzIHJlcGVhdGVk
IGNoZWNrcyBvZiB0aGUgem9uZWxpc3QKPgo+IFBhdGNoIDYgYnJlYWtzIHRoZSBhbGxvY2F0b3Ig
dXAgaW50byBhIGZhc3QgYW5kIHNsb3cgcGF0aCB3aGVyZSB0aGUgZmFzdAo+IHBhdGggbGF0ZXIg
YmVjb21lcyBvbmUgbG9uZyBpbmxpbmVkIGZ1bmN0aW9uLgo+Cj4gUGF0Y2hlcyA3LTEwIGF2b2lk
cyBjYWxjdWxhdGluZyB0aGUgc2FtZSB0aGluZ3MgcmVwZWF0ZWRseSBhbmQgaW5zdGVhZAo+IGNh
bGN1bGF0ZXMgdGhlbSBvbmNlLgo+Cj4gUGF0Y2hlcyAxMS0xMyBpbmxpbmUgdGhlIHdob2xlIGFs
bG9jYXRvciBmYXN0IHBhdGgKPgo+IFBhdGNoIDE0IGF2b2lkcyBjYWxsaW5nIGdldF9wYWdlYmxv
Y2tfbWlncmF0ZXR5cGUoKSBwb3RlbnRpYWxseSB0d2ljZSBvbgo+IGV2ZXJ5IHBhZ2UgZnJlZQo+
Cj4gUGF0Y2ggMTUgcmVkdWNlcyB0aGUgbnVtYmVyIG9mIHRpbWVzIGludGVycnVwdHMgYXJlIGRp
c2FibGVkIGJ5IHJld29ya2luZwo+IHdoYXQgZnJlZV9wYWdlX21sb2NrKCkgZG9lcy4gSG93ZXZl
ciwgSSBub3RpY2UgdGhhdCB0aGUgY29zdCBvZiBjYWxsaW5nCj4gVGVzdENsZWFyUGFnZU1sb2Nr
ZWQoKSBpcyBzdGlsbCBxdWl0ZSBoaWdoIGFuZCBJJ20gZ3Vlc3NpbmcgaXQncyBiZWNhdXNlCj4g
aXQncyBhIGxvY2tlZCBiaXQgb3BlcmF0aW9uLiBJdCdzIGJlIG5pY2UgaWYgaXQgY291bGQgYmUg
ZXN0YWJsaXNoZWQgaWYKPiBpdCdzIHNhZmUgdG8gdXNlIGFuIHVubG9ja2VkIHZlcnNpb24gaGVy
ZS4gUmlrLCBjYW4geW91IGNvbW1lbnQ/CgpZZXMsIGl0IGNhbi4gcGFnZSBmbGFncyBhcmUgb3du
ZWQgZW50aXJlbHkgYnkgdGhlIG93bmVyIG9mIHRoZSBwYWdlLgoKZnJlZV9wYWdlX21sb2NrIHNo
b3VsZG4ndCByZWFsbHkgYmUgaW4gZnJlZV9wYWdlc19jaGVjaywgYnV0IG9oIHdlbGwuCgoKPiBQ
YXRjaCAxNiBhdm9pZHMgdXNpbmcgdGhlIHpvbmVsaXN0IGNhY2hlIG9uIG5vbi1OVU1BIG1hY2hp
bmVzCj4KPiBQYXRjaCAxNyByZW1vdmVzIGFuIGV4cGVuc2l2ZSBhbmQgZXhjZXNzaXZlbHkgcGFy
YW5vaWQgY2hlY2sgaW4gdGhlCj4gYWxsb2NhdG9yIGZhc3QgcGF0aAoKSSB3b3VsZCBiZSBjYXJl
ZnVsIG9mIHJlbW92aW5nIHVzZWZ1bCBkZWJ1ZyBjaGVja3MgY29tcGxldGVseSBsaWtlCnRoaXMu
IFdoYXQgaXMgdGhlIGNvc3Q/IE9idmlvdXNseSBub24temVybywgYnV0IGl0IGlzIGFsc28gYSBj
aGVjawpJIGhhdmUgc2VlbiB0cmlnZ2VyIG9uIHF1aXRlIGEgbG90IG9mIG9jY2FzaW9ucyAoZHVl
IHRvIGtlcm5lbCBidWdzCmFuZCBoYXJkd2FyZSBidWdzLCBhbmQgaW4gZWFjaCBjYXNlIGl0IGlz
IGJldHRlciB0byB3YXJuIHRoYW4gbm90LApldmVuIGlmIG1hbnkgb3RoZXIgc2l0dWF0aW9ucyBj
YW4gZ28gdW5kZXRlY3RlZCkuCgpPbmUgcHJvYmxlbSBpcyB0aGF0IHNvbWUgb2YgdGhlIGNhbGxz
IHdlJ3JlIG1ha2luZyBpbiBwYWdlX2FsbG9jLmMKZG8gdGhlIGNvbXBvdW5kX2hlYWQoKSB0aGlu
Zywgd2hlcmFzIHdlIGtub3cgdGhhdCB3ZSBvbmx5IHdhbnQgdG8KbG9vayBhdCB0aGlzIHBhZ2Uu
IEkndmUgYXR0YWNoZWQgYSBwYXRjaCB3aGljaCBjdXRzIG91dCBhYm91dCAxNTAKYnl0ZXMgb2Yg
dGV4dCBhbmQgc2V2ZXJhbCBicmFuY2hlcyBmcm9tIHRoZXNlIHBhdGhzLgoKCj4gUGF0Y2ggMTgg
YXZvaWRzIGEgbGlzdCBzZWFyY2ggaW4gdGhlIGFsbG9jYXRvciBmYXN0IHBhdGguCgpBaCwgdGhp
cyB3YXMgYmFkbHkgbmVlZGVkIDopCgoKPiBvIE9uIG1hbnkgbWFjaGluZXMsIEknbSBzZWVpbmcg
YSAwLTIlIGltcHJvdmVtZW50IG9uIGtlcm5iZW5jaC4gVGhlCj4gZG9taW5hbnQgY29zdCBpbiBr
ZXJuYmVuY2ggaXMgdGhlIGNvbXBpbGVyIGFuZCB6ZXJvaW5nIGFsbG9jYXRlZCBwYWdlcyBmb3IK
PiBwYWdldGFibGVzLgoKemVyb2luZyBpcyBhIGZhY3RvciwgYnV0IElJUkMgcGFnZSBmYXVsdHMg
YW5kIHBhZ2UgYWxsb2NhdG9yIGFyZSBhbW9uZwp0aGUgdG9wIG9mIHRoZSBwcm9maWxlcy4KCj4g
byBGb3IgdGJlbmNoLCBJIGhhdmUgc2VlbiBhbiA4LTEyJSBpbXByb3ZlbWVudCBvbiB0d28geDg2
LTY0IG1hY2hpbmVzCj4gKGVsbTNiNiBvbiB0ZXN0Lmtlcm5lbC5vcmcgZ2FpbmVkIDglKSBidXQg
Z2VuZXJhbGx5IGl0IHdhcyBsZXNzIGRyYW1hdGljIG9uCj4geDg2LTY0IGluIHRoZSByYW5nZSBv
ZiAwLTQlLiBPbiBvbmUgUFBDNjQsIHRoZSBkaWZmZXJlbnQgd2FzIGFsc28gaW4gdGhlCj4gcmFu
Z2Ugb2YgMC00JS4gR2VuZXJhbGx5IHRoZXJlIHdlcmUgZ2FpbnMsIGJ1dCBvbmUgc3BlY2lmaWMg
cHBjNjQgc2hvd2VkIGEKPiByZWdyZXNzaW9uIG9mIDclIGZvciBvbmUgY2xpZW50IGJ1dCBhIG5l
Z2xpZ2libGUgZGlmZmVyZW5jZSBmb3IgOCBjbGllbnRzLgo+IEl0J3Mgbm90IGNsZWFyIHdoeSB0
aGlzIG1hY2hpbmUgcmVncmVzc2VkIGFuZCBvdGhlcnMgZGlkbid0LgoKRGlkIHlvdSBiaXNlY3Qg
eW91ciBwYXRjaHNldD8gSXQgY291bGQgaGF2ZSBiZWVuIHJhbmRvbSBvciBwb2ludGVkIHRvCmVn
IHRoZSBob3QvY29sZCByZW1vdmFsPwoKPiBvIGhhY2tiZW5jaCBpcyBoYXJkZXIgdG8gY29uY2x1
ZGUgYW55dGhpbmcgZnJvbS4gTW9zdCBtYWNoaW5lcyBzaG93ZWQKPiAgIHBlcmZvcm1hbmNlIGdh
aW5zIGluIHRoZSA1LTExJSByYW5nZSBidXQgb25lIG1hY2hpbmUgaW4gcGFydGljdWxhciBzaG93
ZWQKPiAgIGEgbWl4IG9mIGdhaW5zIGFuZCBsb3NzZXMgZGVwZW5kaW5nIG9uIHRoZSBudW1iZXIg
b2YgY2xpZW50cy4gTWlnaHQgYmUKPiAgIGEgY2FjaGluZyB0aGluZy4KPgo+IG8gT25lIG1hY2hp
bmUgaW4gcGFydGljdWxhciB3YXMgYSBtYWpvciBzdXJwcmlzZSBmb3Igc3lzYmVuY2ggd2l0aCBn
YWlucwo+ICAgb2YgNC04JSB0aGVyZSB3aGljaCB3YXMgZHJhc3RpY2FsbHkgaGlnaGVyIHRoYW4g
SSB3YXMgZXhwZWN0aW5nLiBIb3dldmVyLAo+ICAgb24gb3RoZXIgbWFjaGluZXMsIGl0IHdhcyBp
biB0aGUgbW9yZSByZWFzb25hYmxlIDAtNCUgcmFuZ2UsIHN0aWxsIHByZXR0eQo+ICAgcmVzcGVj
dGFibGUuIEl0J3Mgbm90IGd1YXJhbnRlZWQgdGhvdWdoLiBXaGlsZSBtb3N0IG1hY2hpbmVzIHNo
b3dlZCBzb21lCj4gICBzb3J0IG9mIGdhaW4sIG9uZSBwcGM2NCBzaG93ZWQgbm8gZGlmZmVyZW5j
ZSBhdCBhbGwuCj4KPiBTbywgYnkgYW5kIGxhcmdlIGl0J3MgYW4gaW1wcm92ZW1lbnQgb2Ygc29t
ZSBzb3J0LgoKCk1vc3Qgb2YgdGhlc2UgYmVuY2htYXJrcyAqcmVhbGx5KiBuZWVkIHRvIGJlIHJ1
biBxdWl0ZSBhIGZldyB0aW1lcyB0byBnZXQKYSByZWFzb25hYmxlIGNvbmZpZGVuY2UuCgpCdXQg
aXQgc291bmRzIHByZXR0eSBwb3NpdGl2ZS4KLS0tCiBtbS9wYWdlX2FsbG9jLmMgfCAgIDEwICsr
KysrLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA1IGluc2VydGlvbnMoKyksIDUgZGVsZXRpb25zKC0p
CgpJbmRleDogbGludXgtMi42L21tL3BhZ2VfYWxsb2MuYwo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBsaW51eC0y
LjYub3JpZy9tbS9wYWdlX2FsbG9jLmMKKysrIGxpbnV4LTIuNi9tbS9wYWdlX2FsbG9jLmMKQEAg
LTQyMCw3ICs0MjAsNyBAQCBzdGF0aWMgaW5saW5lIGludCBwYWdlX2lzX2J1ZGR5KHN0cnVjdCBw
CiAJCXJldHVybiAwOwogCiAJaWYgKFBhZ2VCdWRkeShidWRkeSkgJiYgcGFnZV9vcmRlcihidWRk
eSkgPT0gb3JkZXIpIHsKLQkJQlVHX09OKHBhZ2VfY291bnQoYnVkZHkpICE9IDApOworCQlWTV9C
VUdfT04ocGFnZV9jb3VudChidWRkeSkgIT0gMCk7CiAJCXJldHVybiAxOwogCX0KIAlyZXR1cm4g
MDsKQEAgLTQ5Myw5ICs0OTMsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgX19mcmVlX29uZV9wYWdl
KHN0cnVjCiBzdGF0aWMgaW5saW5lIGludCBmcmVlX3BhZ2VzX2NoZWNrKHN0cnVjdCBwYWdlICpw
YWdlKQogewogCWZyZWVfcGFnZV9tbG9jayhwYWdlKTsKLQlpZiAodW5saWtlbHkocGFnZV9tYXBj
b3VudChwYWdlKSB8CisJaWYgKHVubGlrZWx5KChhdG9taWNfcmVhZCgmcGFnZS0+X21hcGNvdW50
KSAhPSAtMSkgfAogCQkocGFnZS0+bWFwcGluZyAhPSBOVUxMKSAgfAotCQkocGFnZV9jb3VudChw
YWdlKSAhPSAwKSAgfAorCQkoYXRvbWljX3JlYWQoJnBhZ2UtPl9jb3VudCkgIT0gMCkgfAogCQko
cGFnZS0+ZmxhZ3MgJiBQQUdFX0ZMQUdTX0NIRUNLX0FUX0ZSRUUpKSkgewogCQliYWRfcGFnZShw
YWdlKTsKIAkJcmV0dXJuIDE7CkBAIC02MzMsOSArNjMzLDkgQEAgc3RhdGljIGlubGluZSB2b2lk
IGV4cGFuZChzdHJ1Y3Qgem9uZSAqegogICovCiBzdGF0aWMgaW50IHByZXBfbmV3X3BhZ2Uoc3Ry
dWN0IHBhZ2UgKnBhZ2UsIGludCBvcmRlciwgZ2ZwX3QgZ2ZwX2ZsYWdzKQogewotCWlmICh1bmxp
a2VseShwYWdlX21hcGNvdW50KHBhZ2UpIHwKKwlpZiAodW5saWtlbHkoKGF0b21pY19yZWFkKCZw
YWdlLT5fbWFwY291bnQpICE9IC0xKSB8CiAJCShwYWdlLT5tYXBwaW5nICE9IE5VTEwpICB8Ci0J
CShwYWdlX2NvdW50KHBhZ2UpICE9IDApICB8CisJCShhdG9taWNfcmVhZCgmcGFnZS0+X2NvdW50
KSAhPSAwKSAgfAogCQkocGFnZS0+ZmxhZ3MgJiBQQUdFX0ZMQUdTX0NIRUNLX0FUX1BSRVApKSkg
ewogCQliYWRfcGFnZShwYWdlKTsKIAkJcmV0dXJuIDE7CgAK

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
