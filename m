Return-Path: <owner-linux-mm@kvack.org>
Received: from psmtp.com (na3sys010amx159.postini.com [74.125.245.159])
	by kanga.kvack.org (Postfix) with SMTP id C38066B0031
	for <linux-mm@kvack.org>; Wed, 24 Jul 2013 02:00:08 -0400 (EDT)
From: Lisa Du <cldu@marvell.com>
Date: Tue, 23 Jul 2013 22:58:23 -0700
Subject: RE: Possible deadloop in direct reclaim?
Message-ID: <89813612683626448B837EE5A0B6A7CB3B62F8F6B0@SC-VEXCH4.marvell.com>
References: <89813612683626448B837EE5A0B6A7CB3B62F8F272@SC-VEXCH4.marvell.com>
	<CAA_GA1ciCDJeBqZv1gHNpQ2VVyDRAVF9_au+fo2dwVvLqnkygA@mail.gmail.com>
	<89813612683626448B837EE5A0B6A7CB3B62F8F61A@SC-VEXCH4.marvell.com>
 <CAA_GA1cruj2-T-+bLb-SfEjC+MuCA7VyopczQSFc=Rx-6s-2kg@mail.gmail.com>
In-Reply-To: <CAA_GA1cruj2-T-+bLb-SfEjC+MuCA7VyopczQSFc=Rx-6s-2kg@mail.gmail.com>
Content-Language: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: Bob Liu <lliubbo@gmail.com>
Cc: "linux-mm@kvack.org" <linux-mm@kvack.org>, Christoph Lameter <cl@linux.com>, Mel Gorman <mgorman@suse.de>, "kosaki.motohiro@jp.fujitsu.com" <kosaki.motohiro@jp.fujitsu.com>

RGVhciBCb2INCiAgIFJlYWxseSBhcHByZWNpYXRlIGZvciB5b3VyIHJldmlldyBhbmQgc3VnZ2Vz
dGlvbnMhDQogICBZZXMsIHlvdXIgc3VnZ2VzdGlvbiBjYW4gZW5kIG15IGluZmluaXRlIGxvb3Ag
aW4gZGlyZWN0X3JlY2xhaW0uIFRoaXMgY2hhbmdlIEkgdGhpbmsgd2lsbCBlYXNpZXIgdGhhbiBi
ZWZvcmUgdG8gbWFyayBhIHpvbmUgYXMgdW5yZWNsYWltYWJsZSByaWdodD8gIFdpbGwgaXQgaGF2
ZSBvdGhlciBzaWRlIGVmZmVjdD8NCg0KICAgSSByZXZpZXdlZCB0aGUgbWFpbmxpbmUncyBwYXRj
aCBsaXN0LCBhbmQgZm91bmQgYmVsb3cgcGF0Y2ggc2hvdWxkIGJlIGEgc2ltaWxhciBjYXNlIGFz
IG1pbmUsIGl0J3MgY2FzZSBpcyBrc3dhcGQgaXMgZnJvemVuLCBidXQgbXkgY2FzZSBrc3dhcGQg
Z28gdG8gc2xlZXAuDQpGcm9tIGQxOTA4MzYyYWUwYjk3Mzc0ZWI4MzI4ZmJiNDcxNTc2MzMyZjlm
YjEgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxDQpGcm9tOiBNaW5jaGFuIEtpbSA8bWluY2hhbi5r
aW1AZ21haWwuY29tPg0KRGF0ZTogV2VkLCAyMiBTZXAgMjAxMCAxMzowNTowMSAtMDcwMA0KU3Vi
amVjdDogW1BBVENIXSB2bXNjYW46IGNoZWNrIGFsbF91bnJlY2xhaW1hYmxlIGluIGRpcmVjdCBy
ZWNsYWltIHBhdGgNCg0KICBCdXQgbGF0ZXIgYmVsb3cgcGF0Y2ggY2hhbmdlZCB0aGUgbG9naWMs
IGFuZCBjaGVja2VkIHRoZSBmbGFnIG9vbV9raWxsZXJfZGlzYWJsZSB3aGljaCBzZWVtcyBvbmx5
IGJlIHNldCB3aGVuIGhpYmVybmF0ZSwgc28gbXkgaXNzdWUgYXBwZWFyZWQuDQoNCkZyb20gOTI5
YmVhN2M3MTQyMjBmYzc2Y2UzZjc1YmVmOTA1NjQ3N2MyOGU3NCBNb24gU2VwIDE3IDAwOjAwOjAw
IDIwMDENCkZyb206IEtPU0FLSSBNb3RvaGlybyA8a29zYWtpLm1vdG9oaXJvQGpwLmZ1aml0c3Uu
Y29tPg0KRGF0ZTogVGh1LCAxNCBBcHIgMjAxMSAxNToyMjoxMiAtMDcwMA0KU3ViamVjdDogW1BB
VENIXSB2bXNjYW46IGFsbF91bnJlY2xhaW1hYmxlKCkgdXNlIHpvbmUtPmFsbF91bnJlY2xhaW1h
YmxlIGFzIGEgbmFtZQ0KQEAgLTIwMDYsMTMgKzIwMDIsMTEgQEAgc3RhdGljIGJvb2wgYWxsX3Vu
cmVjbGFpbWFibGUoc3RydWN0IHpvbmVsaXN0ICp6b25lbGlzdCwNCiAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgIGlmICghY3B1c2V0X3pvbmVfYWxsb3dl
ZF9oYXJkd2FsbCh6b25lLCBHRlBfS0VSTkVMKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnRpbnVlOw0KLSAgICAgICAgICAgICAgIGlmICh6b25lX3JlY2xhaW1hYmxlKHpvbmUpKSB7DQot
ICAgICAgICAgICAgICAgICAgICAgICBhbGxfdW5yZWNsYWltYWJsZSA9IGZhbHNlOw0KLSAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWs7DQotICAgICAgICAgICAgICAgfQ0KKyAgICAgICAgICAg
ICAgIGlmICghem9uZS0+YWxsX3VucmVjbGFpbWFibGUpDQorICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCg0KLSAgICAgICByZXR1cm4gYWxsX3VucmVjbGFp
bWFibGU7DQorICAgICAgIHJldHVybiB0cnVlOw0KIH0NCg0KIC8qDQpAQCAtMjEwOCw2ICsyMTAy
LDE0IEBAIG91dDoNCiAgICAgICAgaWYgKHNjLT5ucl9yZWNsYWltZWQpDQogICAgICAgICAgICAg
ICAgcmV0dXJuIHNjLT5ucl9yZWNsYWltZWQ7DQoNCisgICAgICAgLyoNCisgICAgICAgICogQXMg
aGliZXJuYXRpb24gaXMgZ29pbmcgb24sIGtzd2FwZCBpcyBmcmVlemVkIHNvIHRoYXQgaXQgY2Fu
J3QgbWFyaw0KKyAgICAgICAgKiB0aGUgem9uZSBpbnRvIGFsbF91bnJlY2xhaW1hYmxlLiBUaHVz
IGJ5cGFzc2luZyBhbGxfdW5yZWNsYWltYWJsZQ0KKyAgICAgICAgKiBjaGVjay4NCisgICAgICAg
ICovDQorICAgICAgIGlmIChvb21fa2lsbGVyX2Rpc2FibGVkKQ0KKyAgICAgICAgICAgICAgIHJl
dHVybiAwOw0KVGhhbmtzIQ0KDQpCZXN0IFJlZ2FyZHMNCkxpc2EgRHUNCg0KDQotLS0tLU9yaWdp
bmFsIE1lc3NhZ2UtLS0tLQ0KRnJvbTogQm9iIExpdSBbbWFpbHRvOmxsaXViYm9AZ21haWwuY29t
XSANClNlbnQ6IDIwMTPlubQ35pyIMjTml6UgMTE6MzkNClRvOiBMaXNhIER1DQpDYzogbGludXgt
bW1Aa3ZhY2sub3JnOyBDaHJpc3RvcGggTGFtZXRlcjsgTWVsIEdvcm1hbg0KU3ViamVjdDogUmU6
IFBvc3NpYmxlIGRlYWRsb29wIGluIGRpcmVjdCByZWNsYWltPw0KDQpPbiBXZWQsIEp1bCAyNCwg
MjAxMyBhdCAxMDoyMyBBTSwgTGlzYSBEdSA8Y2xkdUBtYXJ2ZWxsLmNvbT4gd3JvdGU6DQo+IERl
YXIgQm9iDQo+ICAgIEFsc28gZnJvbSBteSBjaGVjayBiZWZvcmUga3N3YXBkIHNsZWVwLCB0aG91
Z2ggbnJfc2xhYiA9IDAgYnV0IHpvbmVfcmVjbGFpbWFibGUoem9uZSkgcmV0dXJucyB0cnVlLCBz
byB6b25lLT5hbGxfdW5yZWNsYWltYWJsZSBjYW4ndCBiZSBjaGFuZ2VkIHRvIDE7IFNvIGV2ZW4g
d2hlbiBjaGFuZ2UgdGhlIG5yX3NsYWIgdG8gc2MtPm5yX3JlY2xhaW1lZCwgaXQgY2FuJ3QgaGVs
cC4NCj4NCg0KVGhlbiB0aGUgb3RoZXIgZml4IG1pZ2h0IGJlIHNldCB6b25lLT5hbGxfdW5yZWNs
YWltYWJsZSBpbiBkaXJlY3QNCnJlY2xhaW0gcGF0aCBhbHNvLCBsaWtlOg0KDQpAQCAtMjI3OCw2
ICsyMjc4LDggQEAgc3RhdGljIGJvb2wgc2hyaW5rX3pvbmVzKHN0cnVjdCB6b25lbGlzdA0KKnpv
bmVsaXN0LCBzdHJ1Y3Qgc2Nhbl9jb250cm9sICpzYykNCiAgICAgICAgICAgICAgICB9DQoNCiAg
ICAgICAgICAgICAgICBzaHJpbmtfem9uZSh6b25lLCBzYyk7DQorICAgICAgICAgICAgICAgaWYg
KHNjLT5ucl9yZWNsYWltZWQgPT0gMCAmJiAhem9uZV9yZWNsYWltYWJsZSh6b25lKSkNCisgICAg
ICAgICAgICAgICAgICAgICAgIHpvbmUtPmFsbF91bnJlY2xhaW1hYmxlID0gMTsNCiAgICAgICAg
fQ0KDQo+IFRoYW5rcyENCj4NCj4gQmVzdCBSZWdhcmRzDQo+IExpc2EgRHUNCj4NCj4NCj4gLS0t
LS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogTGlzYSBEdQ0KPiBTZW50OiAyMDEz5bm0
N+aciDI05pelIDk6MzENCj4gVG86ICdCb2IgTGl1Jw0KPiBDYzogbGludXgtbW1Aa3ZhY2sub3Jn
OyBDaHJpc3RvcGggTGFtZXRlcjsgTWVsIEdvcm1hbg0KPiBTdWJqZWN0OiBSRTogUG9zc2libGUg
ZGVhZGxvb3AgaW4gZGlyZWN0IHJlY2xhaW0/DQo+DQo+IERlYXIgQm9iDQo+ICAgICBUaGFuayB5
b3Ugc28gbXVjaCBmb3IgdGhlIGNhcmVmdWwgcmV2aWV3LCBZZXMsIGl0J3MgYSB0eXBvLCBJIG1l
YW4gem9uZS0+YWxsX3VucmVjbGFpbWFibGUgPSAwLg0KPiAgICAgWW91IG1lbnRpb25lZCBhZGQg
dGhlIGNoZWNrIGluIGtzd2FwZF9zaHJpbmtfem9uZSgpLCBzb3JyeSB0aGF0IEkgZGlkbid0IGZp
bmQgdGhpcyBmdW5jdGlvbiBpbiBrZXJuZWwzLjQgb3Iga2VybmVsMy45Lg0KPiAgICAgSXMgdGhp
cyBmdW5jdGlvbiBjYWxsZWQgaW4gZGlyZWN0X3JlY2xhaW0/DQo+ICAgICBBcyBJIG1lbnRpb25l
ZCB0aGlzIGlzc3VlIGhhcHBlbmVkIGFmdGVyIGtzd2FwZCB0aHJlYWQgc2xlZXAsIGlmIGl0IG9u
bHkgY2FsbGVkIGluIGtzd2FwZCwgdGhlbiBJIHRoaW5rIGl0IGNhbid0IGhlbHAuDQo+DQo+IFRo
YW5rcyENCj4NCj4gQmVzdCBSZWdhcmRzDQo+IExpc2EgRHUNCj4NCj4NCj4gLS0tLS1PcmlnaW5h
bCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogQm9iIExpdSBbbWFpbHRvOmxsaXViYm9AZ21haWwuY29t
XQ0KPiBTZW50OiAyMDEz5bm0N+aciDI05pelIDk6MTgNCj4gVG86IExpc2EgRHUNCj4gQ2M6IGxp
bnV4LW1tQGt2YWNrLm9yZzsgQ2hyaXN0b3BoIExhbWV0ZXI7IE1lbCBHb3JtYW4NCj4gU3ViamVj
dDogUmU6IFBvc3NpYmxlIGRlYWRsb29wIGluIGRpcmVjdCByZWNsYWltPw0KPg0KPiBPbiBUdWUs
IEp1bCAyMywgMjAxMyBhdCAxMjo1OCBQTSwgTGlzYSBEdSA8Y2xkdUBtYXJ2ZWxsLmNvbT4gd3Jv
dGU6DQo+PiBEZWFyIFNpcjoNCj4+DQo+PiBDdXJyZW50bHkgSSBtZXQgYSBwb3NzaWJsZSBkZWFk
bG9vcCBpbiBkaXJlY3QgcmVjbGFpbS4gQWZ0ZXIgcnVuIHBsZW50eSBvZg0KPj4gdGhlIGFwcGxp
Y2F0aW9uLCBzeXN0ZW0gcnVuIGludG8gYSBzdGF0dXMgdGhhdCBzeXN0ZW0gbWVtb3J5IGlzIHZl
cnkNCj4+IGZyYWdtZW50aXplZC4gTGlrZSBvbmx5IG9yZGVyLTAgYW5kIG9yZGVyLTEgbWVtb3J5
IGxlZnQuDQo+Pg0KPj4gVGhlbiBvbmUgcHJvY2VzcyByZXF1aXJlZCBhIG9yZGVyLTIgYnVmZmVy
IGJ1dCBpdCBlbnRlciBhbiBlbmRsZXNzIGRpcmVjdA0KPj4gcmVjbGFpbS4gRnJvbSBteSB0cmFj
ZSBsb2csIEkgY2FuIHNlZSB0aGlzIGxvb3AgYWxyZWFkeSBvdmVyIDIwMCwwMDAgdGltZXMuDQo+
PiBLc3dhcGQgd2FzIGZpcnN0IHdha2UgdXAgYW5kIHRoZW4gZ28gYmFjayB0byBzbGVlcCBhcyBp
dCBjYW5ub3QgcmViYWxhbmNlDQo+PiB0aGlzIG9yZGVy4oCZcyBtZW1vcnkuIEJ1dCB6b25lLT5h
bGxfdW5yZWNsYWltYWJsZSByZW1haW5zIDEuDQo+Pg0KPj4gVGhvdWdoIGRpcmVjdF9yZWNsYWlt
IGV2ZXJ5IHRpbWUgcmV0dXJucyBubyBwYWdlcywgYnV0IGFzDQo+PiB6b25lLT5hbGxfdW5yZWNs
YWltYWJsZSA9IDEsIHNvIGl0IGxvb3AgYWdhaW4gYW5kIGFnYWluLiBFdmVuIHdoZW4NCj4+IHpv
bmUtPnBhZ2VzX3NjYW5uZWQgYWxzbyBiZWNvbWVzIHZlcnkgbGFyZ2UuIEl0IHdpbGwgYmxvY2sg
dGhlIHByb2Nlc3MgZm9yDQo+PiBsb25nIHRpbWUsIHVudGlsIHNvbWUgd2F0Y2hkb2cgdGhyZWFk
IGRldGVjdCB0aGlzIGFuZCBraWxsIHRoaXMgcHJvY2Vzcy4NCj4+IFRob3VnaCBpdOKAmXMgaW4g
X19hbGxvY19wYWdlc19zbG93cGF0aCwgYnV0IGl04oCZcyB0b28gc2xvdyByaWdodD8gTWF5YmUg
Y29zdA0KPj4gb3ZlciA1MCBzZWNvbmRzIG9yIGV2ZW4gbW9yZS4NCj4NCj4gWW91IG11c3QgYmUg
bWVhbiB6b25lLT5hbGxfdW5yZWNsYWltYWJsZSA9IDA/DQo+DQo+Pg0KPj4gSSB0aGluayBpdOKA
mXMgbm90IGFzIGV4cGVjdGVkIHJpZ2h0PyAgQ2FuIHdlIGFsc28gYWRkIGJlbG93IGNoZWNrIGlu
IHRoZQ0KPj4gZnVuY3Rpb24gYWxsX3VucmVjbGFpbWFibGUoKSB0byB0ZXJtaW5hdGUgdGhpcyBs
b29wPw0KPj4NCj4+DQo+Pg0KPj4gQEAgLTIzNTUsNiArMjM1NSw4IEBAIHN0YXRpYyBib29sIGFs
bF91bnJlY2xhaW1hYmxlKHN0cnVjdCB6b25lbGlzdA0KPj4gKnpvbmVsaXN0LA0KPj4NCj4+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KPj4NCj4+ICAgICAgICAgICAgICAgICBp
ZiAoIXpvbmUtPmFsbF91bnJlY2xhaW1hYmxlKQ0KPj4NCj4+ICAgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybiBmYWxzZTsNCj4+DQo+PiArICAgICAgICAgICAgICAgaWYgKHNjLT5ucl9yZWNs
YWltZWQgPT0gMCAmJiAhem9uZV9yZWNsYWltYWJsZSh6b25lKSkNCj4+DQo+PiArICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCj4+DQo+DQo+IEhvdyBhYm91dCByZXBsYWNlIHRo
ZSBjaGVja2luZyBpbiBrc3dhcGRfc2hyaW5rX3pvbmUoKT8NCj4NCj4gQEAgLTI4MjQsNyArMjgy
NCw3IEBAIHN0YXRpYyBib29sIGtzd2FwZF9zaHJpbmtfem9uZShzdHJ1Y3Qgem9uZSAqem9uZSwN
Cj4gICAgICAgICAvKiBBY2NvdW50IGZvciB0aGUgbnVtYmVyIG9mIHBhZ2VzIGF0dGVtcHRlZCB0
byByZWNsYWltICovDQo+ICAgICAgICAgKm5yX2F0dGVtcHRlZCArPSBzYy0+bnJfdG9fcmVjbGFp
bTsNCj4NCj4gLSAgICAgICBpZiAobnJfc2xhYiA9PSAwICYmICF6b25lX3JlY2xhaW1hYmxlKHpv
bmUpKQ0KPiArICAgICAgIGlmIChzYy0+bnJfcmVjbGFpbWVkID09IDAgJiYgIXpvbmVfcmVjbGFp
bWFibGUoem9uZSkpDQo+ICAgICAgICAgICAgICAgICB6b25lLT5hbGxfdW5yZWNsYWltYWJsZSA9
IDE7DQo+DQo+ICAgICAgICAgem9uZV9jbGVhcl9mbGFnKHpvbmUsIFpPTkVfV1JJVEVCQUNLKTsN
Cj4NCj4NCj4gSSB0aGluayB0aGUgY3VycmVudCBjaGVjayBpcyB3cm9uZywgcmVjbGFpbWVkIGEg
c2xhYiBkb2Vzbid0IG1lYW4NCj4gcmVjbGFpbWVkIGEgcGFnZS4NCj4NCj4gLS0NCj4gUmVnYXJk
cywNCj4gLS1Cb2INCg0KDQoNCi0tIA0KUmVnYXJkcywNCi0tQm9iDQo=

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
