Return-Path: <owner-linux-mm@kvack.org>
Received: from mail-pa0-f42.google.com (mail-pa0-f42.google.com [209.85.220.42])
	by kanga.kvack.org (Postfix) with ESMTP id C50359003C8
	for <linux-mm@kvack.org>; Sun,  9 Aug 2015 20:53:07 -0400 (EDT)
Received: by pabyb7 with SMTP id yb7so93881950pab.0
        for <linux-mm@kvack.org>; Sun, 09 Aug 2015 17:53:07 -0700 (PDT)
Received: from tyo200.gate.nec.co.jp (TYO200.gate.nec.co.jp. [210.143.35.50])
        by mx.google.com with ESMTPS id hk2si829423pbb.131.2015.08.09.17.53.03
        for <linux-mm@kvack.org>
        (version=TLSv1 cipher=RC4-SHA bits=128/128);
        Sun, 09 Aug 2015 17:53:04 -0700 (PDT)
Received: from tyo201.gate.nec.co.jp ([10.7.69.201])
	by tyo200.gate.nec.co.jp (8.13.8/8.13.4) with ESMTP id t7A0r0T7020273
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <linux-mm@kvack.org>; Mon, 10 Aug 2015 09:53:01 +0900 (JST)
From: Naoya Horiguchi <n-horiguchi@ah.jp.nec.com>
Subject: [PATCH v3 2/3] mm: hugetlb: add VmHugetlbRSS: field in
 /proc/pid/status
Date: Mon, 10 Aug 2015 00:47:09 +0000
Message-ID: <1439167624-17772-3-git-send-email-n-horiguchi@ah.jp.nec.com>
References: <20150807155537.d483456f753355059f9ce10a@linux-foundation.org>
 <1439167624-17772-1-git-send-email-n-horiguchi@ah.jp.nec.com>
In-Reply-To: <1439167624-17772-1-git-send-email-n-horiguchi@ah.jp.nec.com>
Content-Language: ja-JP
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: Andrew Morton <akpm@linux-foundation.org>, David Rientjes <rientjes@google.com>, =?utf-8?B?SsO2cm4gRW5nZWw=?= <joern@purestorage.com>
Cc: Mike Kravetz <mike.kravetz@oracle.com>, "linux-mm@kvack.org" <linux-mm@kvack.org>, "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>, Naoya Horiguchi <nao.horiguchi@gmail.com>, Naoya Horiguchi <n-horiguchi@ah.jp.nec.com>

Q3VycmVudGx5IHRoZXJlJ3Mgbm8gZWFzeSB3YXkgdG8gZ2V0IHBlci1wcm9jZXNzIHVzYWdlIG9m
IGh1Z2V0bGIgcGFnZXMsIHdoaWNoDQppcyBpbmNvbnZlbmllbnQgYmVjYXVzZSBhcHBsaWNhdGlv
bnMgd2hpY2ggdXNlIGh1Z2V0bGIgdHlwaWNhbGx5IHdhbnQgdG8gY29udHJvbA0KdGhlaXIgcHJv
Y2Vzc2VzIG9uIHRoZSBiYXNpcyBvZiBob3cgbXVjaCBtZW1vcnkgKGluY2x1ZGluZyBodWdldGxi
KSB0aGV5IHVzZS4NClNvIHRoaXMgcGF0Y2ggc2ltcGx5IHByb3ZpZGVzIGVhc3kgYWNjZXNzIHRv
IHRoZSBpbmZvIHZpYSAvcHJvYy9waWQvc3RhdHVzLg0KDQpUaGlzIHBhdGNoIHNob3VsZG4ndCBj
aGFuZ2UgdGhlIE9PTSBiZWhhdmlvciAoc28gaHVnZXRsYiB1c2FnZSBpcyBpZ25vcmVkIGFzDQpp
cyBub3csKSB3aGljaCBJIGd1ZXNzIGlzIGZpbmUgdW50aWwgd2UgaGF2ZSBzb21lIHN0cm9uZyBy
ZWFzb24gdG8gZG8gaXQuDQoNClNpZ25lZC1vZmYtYnk6IE5hb3lhIEhvcmlndWNoaSA8bi1ob3Jp
Z3VjaGlAYWguanAubmVjLmNvbT4NCi0tLQ0KdjIgLT4gdjM6DQotIHVzZSBpbmxpbmUgZnVuY3Rp
b25zIGluc3RlYWQgb2YgbWFjcm9zIGZvciAhQ09ORklHX0hVR0VUTEJfUEFHRQ0KLS0tDQogZnMv
cHJvYy90YXNrX21tdS5jICAgICAgIHwgIDUgKysrKy0NCiBpbmNsdWRlL2xpbnV4L2h1Z2V0bGIu
aCAgfCAyNCArKysrKysrKysrKysrKysrKysrKysrKysNCiBpbmNsdWRlL2xpbnV4L21tLmggICAg
ICAgfCAgMyArKysNCiBpbmNsdWRlL2xpbnV4L21tX3R5cGVzLmggfCAgMyArKysNCiBtbS9odWdl
dGxiLmMgICAgICAgICAgICAgfCAgOSArKysrKysrKysNCiBtbS9tZW1vcnkuYyAgICAgICAgICAg
ICAgfCAgNCArKy0tDQogbW0vcm1hcC5jICAgICAgICAgICAgICAgIHwgIDQgKysrLQ0KIDcgZmls
ZXMgY2hhbmdlZCwgNDggaW5zZXJ0aW9ucygrKSwgNCBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdp
dCB2NC4yLXJjNC5vcmlnL2ZzL3Byb2MvdGFza19tbXUuYyB2NC4yLXJjNC9mcy9wcm9jL3Rhc2tf
bW11LmMNCmluZGV4IGM3MjE4NjAzMzA2ZC4uZjE4MWY1NmZjY2UyIDEwMDY0NA0KLS0tIHY0LjIt
cmM0Lm9yaWcvZnMvcHJvYy90YXNrX21tdS5jDQorKysgdjQuMi1yYzQvZnMvcHJvYy90YXNrX21t
dS5jDQpAQCAtMjIsNyArMjIsNyBAQA0KIHZvaWQgdGFza19tZW0oc3RydWN0IHNlcV9maWxlICpt
LCBzdHJ1Y3QgbW1fc3RydWN0ICptbSkNCiB7DQogCXVuc2lnbmVkIGxvbmcgZGF0YSwgdGV4dCwg
bGliLCBzd2FwLCBwdGVzLCBwbWRzOw0KLQl1bnNpZ25lZCBsb25nIGhpd2F0ZXJfdm0sIHRvdGFs
X3ZtLCBoaXdhdGVyX3JzcywgdG90YWxfcnNzOw0KKwl1bnNpZ25lZCBsb25nIGhpd2F0ZXJfdm0s
IHRvdGFsX3ZtLCBoaXdhdGVyX3JzcywgdG90YWxfcnNzLCBodWdldGxiX3JzczsNCiANCiAJLyoN
CiAJICogTm90ZTogdG8gbWluaW1pemUgdGhlaXIgb3ZlcmhlYWQsIG1tIG1haW50YWlucyBoaXdh
dGVyX3ZtIGFuZA0KQEAgLTM3LDYgKzM3LDcgQEAgdm9pZCB0YXNrX21lbShzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQ0KIAloaXdhdGVyX3JzcyA9IHRvdGFsX3JzcyA9
IGdldF9tbV9yc3MobW0pOw0KIAlpZiAoaGl3YXRlcl9yc3MgPCBtbS0+aGl3YXRlcl9yc3MpDQog
CQloaXdhdGVyX3JzcyA9IG1tLT5oaXdhdGVyX3JzczsNCisJaHVnZXRsYl9yc3MgPSBnZXRfaHVn
ZXRsYl9yc3MobW0pOw0KIA0KIAlkYXRhID0gbW0tPnRvdGFsX3ZtIC0gbW0tPnNoYXJlZF92bSAt
IG1tLT5zdGFja192bTsNCiAJdGV4dCA9IChQQUdFX0FMSUdOKG1tLT5lbmRfY29kZSkgLSAobW0t
PnN0YXJ0X2NvZGUgJiBQQUdFX01BU0spKSA+PiAxMDsNCkBAIC01MSw2ICs1Miw3IEBAIHZvaWQg
dGFza19tZW0oc3RydWN0IHNlcV9maWxlICptLCBzdHJ1Y3QgbW1fc3RydWN0ICptbSkNCiAJCSJW
bVBpbjpcdCU4bHUga0JcbiINCiAJCSJWbUhXTTpcdCU4bHUga0JcbiINCiAJCSJWbVJTUzpcdCU4
bHUga0JcbiINCisJCSJWbUh1Z2V0bGJSU1M6XHQlOGx1IGtCXG4iDQogCQkiVm1EYXRhOlx0JThs
dSBrQlxuIg0KIAkJIlZtU3RrOlx0JThsdSBrQlxuIg0KIAkJIlZtRXhlOlx0JThsdSBrQlxuIg0K
QEAgLTY0LDYgKzY2LDcgQEAgdm9pZCB0YXNrX21lbShzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHN0cnVj
dCBtbV9zdHJ1Y3QgKm1tKQ0KIAkJbW0tPnBpbm5lZF92bSA8PCAoUEFHRV9TSElGVC0xMCksDQog
CQloaXdhdGVyX3JzcyA8PCAoUEFHRV9TSElGVC0xMCksDQogCQl0b3RhbF9yc3MgPDwgKFBBR0Vf
U0hJRlQtMTApLA0KKwkJaHVnZXRsYl9yc3MgPDwgKFBBR0VfU0hJRlQtMTApLA0KIAkJZGF0YSA8
PCAoUEFHRV9TSElGVC0xMCksDQogCQltbS0+c3RhY2tfdm0gPDwgKFBBR0VfU0hJRlQtMTApLCB0
ZXh0LCBsaWIsDQogCQlwdGVzID4+IDEwLA0KZGlmZiAtLWdpdCB2NC4yLXJjNC5vcmlnL2luY2x1
ZGUvbGludXgvaHVnZXRsYi5oIHY0LjItcmM0L2luY2x1ZGUvbGludXgvaHVnZXRsYi5oDQppbmRl
eCBkODkxZjk0OTQ2NmEuLmZhOTU2ZDk0Y2FjYiAxMDA2NDQNCi0tLSB2NC4yLXJjNC5vcmlnL2lu
Y2x1ZGUvbGludXgvaHVnZXRsYi5oDQorKysgdjQuMi1yYzQvaW5jbHVkZS9saW51eC9odWdldGxi
LmgNCkBAIC00NjksNiArNDY5LDIxIEBAIHN0YXRpYyBpbmxpbmUgc3BpbmxvY2tfdCAqaHVnZV9w
dGVfbG9ja3B0cihzdHJ1Y3QgaHN0YXRlICpoLA0KICNkZWZpbmUgaHVnZXBhZ2VzX3N1cHBvcnRl
ZCgpIChIUEFHRV9TSElGVCAhPSAwKQ0KICNlbmRpZg0KIA0KKy8qDQorICogVGhpcyBzaW1wbGUg
d3JhcHBlcnMgYXJlIHRvIGhpZGUgTU1fSFVHRVRMQlBBR0VTIGZyb20gb3V0c2lkZSBodWdldGxi
ZnMNCisgKiBzdWJzeXN0ZW0uIFRoZSBjb3VudGVyIE1NX0hVR0VUTEJQQUdFUyBpcyBtYWludGFp
bmVkIGluIHBhZ2UgdW5pdCBiYXNpcywNCisgKiBzbyBpdCBjaGFuZ2VzIGJ5IDUxMiBmb3IgZXhh
bXBsZSBpZiBhIDJNQiBodWdlcGFnZSBpcyBtYXBwZWQgb3IgdW5tYXBwZWQuDQorICovDQorc3Rh
dGljIGlubGluZSBpbnQgZ2V0X2h1Z2V0bGJfcnNzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tKQ0KK3sN
CisJcmV0dXJuIGdldF9tbV9jb3VudGVyKG1tLCBNTV9IVUdFVExCUEFHRVMpOw0KK30NCisNCitz
dGF0aWMgaW5saW5lIHZvaWQgbW9kX2h1Z2V0bGJfcnNzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBs
b25nIHZhbHVlKQ0KK3sNCisJYWRkX21tX2NvdW50ZXIobW0sIE1NX0hVR0VUTEJQQUdFUywgdmFs
dWUpOw0KK30NCisNCiAjZWxzZQkvKiBDT05GSUdfSFVHRVRMQl9QQUdFICovDQogc3RydWN0IGhz
dGF0ZSB7fTsNCiAjZGVmaW5lIGFsbG9jX2h1Z2VfcGFnZV9ub2RlKGgsIG5pZCkgTlVMTA0KQEAg
LTUwNCw2ICs1MTksMTUgQEAgc3RhdGljIGlubGluZSBzcGlubG9ja190ICpodWdlX3B0ZV9sb2Nr
cHRyKHN0cnVjdCBoc3RhdGUgKmgsDQogew0KIAlyZXR1cm4gJm1tLT5wYWdlX3RhYmxlX2xvY2s7
DQogfQ0KKw0KK3N0YXRpYyBpbmxpbmUgZ2V0X2h1Z2V0bGJfcnNzKHN0cnVjdCBtbV9zdHJ1Y3Qg
Km1tKQ0KK3sNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgbW9kX2h1Z2V0bGJf
cnNzKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBsb25nIHZhbHVlKQ0KK3sNCit9DQogI2VuZGlmCS8q
IENPTkZJR19IVUdFVExCX1BBR0UgKi8NCiANCiBzdGF0aWMgaW5saW5lIHNwaW5sb2NrX3QgKmh1
Z2VfcHRlX2xvY2soc3RydWN0IGhzdGF0ZSAqaCwNCmRpZmYgLS1naXQgdjQuMi1yYzQub3JpZy9p
bmNsdWRlL2xpbnV4L21tLmggdjQuMi1yYzQvaW5jbHVkZS9saW51eC9tbS5oDQppbmRleCAyZTg3
MmY5MmRiYWMuLjkyMThhODg1NjQ4MyAxMDA2NDQNCi0tLSB2NC4yLXJjNC5vcmlnL2luY2x1ZGUv
bGludXgvbW0uaA0KKysrIHY0LjItcmM0L2luY2x1ZGUvbGludXgvbW0uaA0KQEAgLTEzNTUsNiAr
MTM1NSw5IEBAIHN0YXRpYyBpbmxpbmUgdm9pZCBzeW5jX21tX3JzcyhzdHJ1Y3QgbW1fc3RydWN0
ICptbSkNCiB9DQogI2VuZGlmDQogDQorZXh0ZXJuIGlubGluZSB2b2lkIGluaXRfcnNzX3ZlYyhp
bnQgKnJzcyk7DQorZXh0ZXJuIGlubGluZSB2b2lkIGFkZF9tbV9yc3NfdmVjKHN0cnVjdCBtbV9z
dHJ1Y3QgKm1tLCBpbnQgKnJzcyk7DQorDQogaW50IHZtYV93YW50c193cml0ZW5vdGlmeShzdHJ1
Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSk7DQogDQogZXh0ZXJuIHB0ZV90ICpfX2dldF9sb2NrZWRf
cHRlKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCB1bnNpZ25lZCBsb25nIGFkZHIsDQpkaWZmIC0tZ2l0
IHY0LjItcmM0Lm9yaWcvaW5jbHVkZS9saW51eC9tbV90eXBlcy5oIHY0LjItcmM0L2luY2x1ZGUv
bGludXgvbW1fdHlwZXMuaA0KaW5kZXggMDAzOGFjNzQ2NmZkLi44ODdiNDNiYTVhMTggMTAwNjQ0
DQotLS0gdjQuMi1yYzQub3JpZy9pbmNsdWRlL2xpbnV4L21tX3R5cGVzLmgNCisrKyB2NC4yLXJj
NC9pbmNsdWRlL2xpbnV4L21tX3R5cGVzLmgNCkBAIC0zNDgsNiArMzQ4LDkgQEAgZW51bSB7DQog
CU1NX0ZJTEVQQUdFUywNCiAJTU1fQU5PTlBBR0VTLA0KIAlNTV9TV0FQRU5UUywNCisjaWZkZWYg
Q09ORklHX0hVR0VUTEJfUEFHRQ0KKwlNTV9IVUdFVExCUEFHRVMsDQorI2VuZGlmDQogCU5SX01N
X0NPVU5URVJTDQogfTsNCiANCmRpZmYgLS1naXQgdjQuMi1yYzQub3JpZy9tbS9odWdldGxiLmMg
djQuMi1yYzQvbW0vaHVnZXRsYi5jDQppbmRleCBhOGMzMDg3MDg5ZDguLjEyZTVlN2QzYjYwZiAx
MDA2NDQNCi0tLSB2NC4yLXJjNC5vcmlnL21tL2h1Z2V0bGIuYw0KKysrIHY0LjItcmM0L21tL2h1
Z2V0bGIuYw0KQEAgLTI3NDMsOSArMjc0MywxMSBAQCBpbnQgY29weV9odWdldGxiX3BhZ2VfcmFu
Z2Uoc3RydWN0IG1tX3N0cnVjdCAqZHN0LCBzdHJ1Y3QgbW1fc3RydWN0ICpzcmMsDQogCXVuc2ln
bmVkIGxvbmcgbW11bl9zdGFydDsJLyogRm9yIG1tdV9ub3RpZmllcnMgKi8NCiAJdW5zaWduZWQg
bG9uZyBtbXVuX2VuZDsJCS8qIEZvciBtbXVfbm90aWZpZXJzICovDQogCWludCByZXQgPSAwOw0K
KwlpbnQgcnNzW05SX01NX0NPVU5URVJTXTsNCiANCiAJY293ID0gKHZtYS0+dm1fZmxhZ3MgJiAo
Vk1fU0hBUkVEIHwgVk1fTUFZV1JJVEUpKSA9PSBWTV9NQVlXUklURTsNCiANCisJaW5pdF9yc3Nf
dmVjKHJzcyk7DQogCW1tdW5fc3RhcnQgPSB2bWEtPnZtX3N0YXJ0Ow0KIAltbXVuX2VuZCA9IHZt
YS0+dm1fZW5kOw0KIAlpZiAoY293KQ0KQEAgLTI3OTcsNiArMjc5OSw3IEBAIGludCBjb3B5X2h1
Z2V0bGJfcGFnZV9yYW5nZShzdHJ1Y3QgbW1fc3RydWN0ICpkc3QsIHN0cnVjdCBtbV9zdHJ1Y3Qg
KnNyYywNCiAJCQlnZXRfcGFnZShwdGVwYWdlKTsNCiAJCQlwYWdlX2R1cF9ybWFwKHB0ZXBhZ2Up
Ow0KIAkJCXNldF9odWdlX3B0ZV9hdChkc3QsIGFkZHIsIGRzdF9wdGUsIGVudHJ5KTsNCisJCQly
c3NbTU1fSFVHRVRMQlBBR0VTXSArPSBwYWdlc19wZXJfaHVnZV9wYWdlKGgpOw0KIAkJfQ0KIAkJ
c3Bpbl91bmxvY2soc3JjX3B0bCk7DQogCQlzcGluX3VubG9jayhkc3RfcHRsKTsNCkBAIC0yODA1
LDYgKzI4MDgsNyBAQCBpbnQgY29weV9odWdldGxiX3BhZ2VfcmFuZ2Uoc3RydWN0IG1tX3N0cnVj
dCAqZHN0LCBzdHJ1Y3QgbW1fc3RydWN0ICpzcmMsDQogCWlmIChjb3cpDQogCQltbXVfbm90aWZp
ZXJfaW52YWxpZGF0ZV9yYW5nZV9lbmQoc3JjLCBtbXVuX3N0YXJ0LCBtbXVuX2VuZCk7DQogDQor
CWFkZF9tbV9yc3NfdmVjKGRzdCwgcnNzKTsNCiAJcmV0dXJuIHJldDsNCiB9DQogDQpAQCAtMjgy
Myw2ICsyODI3LDcgQEAgdm9pZCBfX3VubWFwX2h1Z2VwYWdlX3JhbmdlKHN0cnVjdCBtbXVfZ2F0
aGVyICp0bGIsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLA0KIAl1bnNpZ25lZCBsb25nIHN6
ID0gaHVnZV9wYWdlX3NpemUoaCk7DQogCWNvbnN0IHVuc2lnbmVkIGxvbmcgbW11bl9zdGFydCA9
IHN0YXJ0OwkvKiBGb3IgbW11X25vdGlmaWVycyAqLw0KIAljb25zdCB1bnNpZ25lZCBsb25nIG1t
dW5fZW5kICAgPSBlbmQ7CS8qIEZvciBtbXVfbm90aWZpZXJzICovDQorCWludCByc3NbTlJfTU1f
Q09VTlRFUlNdOw0KIA0KIAlXQVJOX09OKCFpc192bV9odWdldGxiX3BhZ2Uodm1hKSk7DQogCUJV
R19PTihzdGFydCAmIH5odWdlX3BhZ2VfbWFzayhoKSk7DQpAQCAtMjgzMiw2ICsyODM3LDcgQEAg
dm9pZCBfX3VubWFwX2h1Z2VwYWdlX3JhbmdlKHN0cnVjdCBtbXVfZ2F0aGVyICp0bGIsIHN0cnVj
dCB2bV9hcmVhX3N0cnVjdCAqdm1hLA0KIAltbXVfbm90aWZpZXJfaW52YWxpZGF0ZV9yYW5nZV9z
dGFydChtbSwgbW11bl9zdGFydCwgbW11bl9lbmQpOw0KIAlhZGRyZXNzID0gc3RhcnQ7DQogYWdh
aW46DQorCWluaXRfcnNzX3ZlYyhyc3MpOw0KIAlmb3IgKDsgYWRkcmVzcyA8IGVuZDsgYWRkcmVz
cyArPSBzeikgew0KIAkJcHRlcCA9IGh1Z2VfcHRlX29mZnNldChtbSwgYWRkcmVzcyk7DQogCQlp
ZiAoIXB0ZXApDQpAQCAtMjg3Nyw2ICsyODgzLDcgQEAgdm9pZCBfX3VubWFwX2h1Z2VwYWdlX3Jh
bmdlKHN0cnVjdCBtbXVfZ2F0aGVyICp0bGIsIHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hLA0K
IAkJaWYgKGh1Z2VfcHRlX2RpcnR5KHB0ZSkpDQogCQkJc2V0X3BhZ2VfZGlydHkocGFnZSk7DQog
DQorCQlyc3NbTU1fSFVHRVRMQlBBR0VTXSAtPSBwYWdlc19wZXJfaHVnZV9wYWdlKGgpOw0KIAkJ
cGFnZV9yZW1vdmVfcm1hcChwYWdlKTsNCiAJCWZvcmNlX2ZsdXNoID0gIV9fdGxiX3JlbW92ZV9w
YWdlKHRsYiwgcGFnZSk7DQogCQlpZiAoZm9yY2VfZmx1c2gpIHsNCkBAIC0yODkyLDYgKzI4OTks
NyBAQCB2b2lkIF9fdW5tYXBfaHVnZXBhZ2VfcmFuZ2Uoc3RydWN0IG1tdV9nYXRoZXIgKnRsYiwg
c3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsDQogdW5sb2NrOg0KIAkJc3Bpbl91bmxvY2socHRs
KTsNCiAJfQ0KKwlhZGRfbW1fcnNzX3ZlYyhtbSwgcnNzKTsNCiAJLyoNCiAJICogbW11X2dhdGhl
ciByYW4gb3V0IG9mIHJvb20gdG8gYmF0Y2ggcGFnZXMsIHdlIGJyZWFrIG91dCBvZg0KIAkgKiB0
aGUgUFRFIGxvY2sgdG8gYXZvaWQgZG9pbmcgdGhlIHBvdGVudGlhbCBleHBlbnNpdmUgVExCIGlu
dmFsaWRhdGUNCkBAIC0zMjYxLDYgKzMyNjksNyBAQCBzdGF0aWMgaW50IGh1Z2V0bGJfbm9fcGFn
ZShzdHJ1Y3QgbW1fc3RydWN0ICptbSwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsDQogCQkJ
CSYmICh2bWEtPnZtX2ZsYWdzICYgVk1fU0hBUkVEKSkpOw0KIAlzZXRfaHVnZV9wdGVfYXQobW0s
IGFkZHJlc3MsIHB0ZXAsIG5ld19wdGUpOw0KIA0KKwltb2RfaHVnZXRsYl9yc3MobW0sIHBhZ2Vz
X3Blcl9odWdlX3BhZ2UoaCkpOw0KIAlpZiAoKGZsYWdzICYgRkFVTFRfRkxBR19XUklURSkgJiYg
ISh2bWEtPnZtX2ZsYWdzICYgVk1fU0hBUkVEKSkgew0KIAkJLyogT3B0aW1pemF0aW9uLCBkbyB0
aGUgQ09XIHdpdGhvdXQgYSBzZWNvbmQgZmF1bHQgKi8NCiAJCXJldCA9IGh1Z2V0bGJfY293KG1t
LCB2bWEsIGFkZHJlc3MsIHB0ZXAsIG5ld19wdGUsIHBhZ2UsIHB0bCk7DQpkaWZmIC0tZ2l0IHY0
LjItcmM0Lm9yaWcvbW0vbWVtb3J5LmMgdjQuMi1yYzQvbW0vbWVtb3J5LmMNCmluZGV4IDM4OGRj
ZjlhYTI4My4uZTA5YjUzZGEyNzMzIDEwMDY0NA0KLS0tIHY0LjItcmM0Lm9yaWcvbW0vbWVtb3J5
LmMNCisrKyB2NC4yLXJjNC9tbS9tZW1vcnkuYw0KQEAgLTYyMCwxMiArNjIwLDEyIEBAIGludCBf
X3B0ZV9hbGxvY19rZXJuZWwocG1kX3QgKnBtZCwgdW5zaWduZWQgbG9uZyBhZGRyZXNzKQ0KIAly
ZXR1cm4gMDsNCiB9DQogDQotc3RhdGljIGlubGluZSB2b2lkIGluaXRfcnNzX3ZlYyhpbnQgKnJz
cykNCitpbmxpbmUgdm9pZCBpbml0X3Jzc192ZWMoaW50ICpyc3MpDQogew0KIAltZW1zZXQocnNz
LCAwLCBzaXplb2YoaW50KSAqIE5SX01NX0NPVU5URVJTKTsNCiB9DQogDQotc3RhdGljIGlubGlu
ZSB2b2lkIGFkZF9tbV9yc3NfdmVjKHN0cnVjdCBtbV9zdHJ1Y3QgKm1tLCBpbnQgKnJzcykNCitp
bmxpbmUgdm9pZCBhZGRfbW1fcnNzX3ZlYyhzdHJ1Y3QgbW1fc3RydWN0ICptbSwgaW50ICpyc3Mp
DQogew0KIAlpbnQgaTsNCiANCmRpZmYgLS1naXQgdjQuMi1yYzQub3JpZy9tbS9ybWFwLmMgdjQu
Mi1yYzQvbW0vcm1hcC5jDQppbmRleCAxNzFiNjg3NjhkZjEuLjc4ZTc3YjBlYTNjMyAxMDA2NDQN
Ci0tLSB2NC4yLXJjNC5vcmlnL21tL3JtYXAuYw0KKysrIHY0LjItcmM0L21tL3JtYXAuYw0KQEAg
LTEyMzAsNyArMTIzMCw5IEBAIHN0YXRpYyBpbnQgdHJ5X3RvX3VubWFwX29uZShzdHJ1Y3QgcGFn
ZSAqcGFnZSwgc3RydWN0IHZtX2FyZWFfc3RydWN0ICp2bWEsDQogCXVwZGF0ZV9oaXdhdGVyX3Jz
cyhtbSk7DQogDQogCWlmIChQYWdlSFdQb2lzb24ocGFnZSkgJiYgIShmbGFncyAmIFRUVV9JR05P
UkVfSFdQT0lTT04pKSB7DQotCQlpZiAoIVBhZ2VIdWdlKHBhZ2UpKSB7DQorCQlpZiAoUGFnZUh1
Z2UocGFnZSkpIHsNCisJCQltb2RfaHVnZXRsYl9yc3MobW0sIC0oMSA8PCBjb21wb3VuZF9vcmRl
cihwYWdlKSkpOw0KKwkJfSBlbHNlIHsNCiAJCQlpZiAoUGFnZUFub24ocGFnZSkpDQogCQkJCWRl
Y19tbV9jb3VudGVyKG1tLCBNTV9BTk9OUEFHRVMpOw0KIAkJCWVsc2UNCi0tIA0KMi40LjMNCg==

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
