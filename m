Return-Path: <owner-linux-mm@kvack.org>
Received: from mail-pa0-f54.google.com (mail-pa0-f54.google.com [209.85.220.54])
	by kanga.kvack.org (Postfix) with ESMTP id 237B06B0032
	for <linux-mm@kvack.org>; Fri, 24 Apr 2015 04:22:06 -0400 (EDT)
Received: by pacyx8 with SMTP id yx8so42290050pac.1
        for <linux-mm@kvack.org>; Fri, 24 Apr 2015 01:22:05 -0700 (PDT)
Received: from mail.sfc.wide.ad.jp (shonan.sfc.wide.ad.jp. [203.178.142.130])
        by mx.google.com with ESMTPS id ag7si16386805pad.120.2015.04.24.01.22.04
        for <linux-mm@kvack.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 24 Apr 2015 01:22:04 -0700 (PDT)
Date: Fri, 24 Apr 2015 17:22:02 +0900
Message-ID: <m2r3randg5.wl@sfc.wide.ad.jp>
From: Hajime Tazaki<tazaki@sfc.wide.ad.jp>
Subject: Re: [RFC PATCH v3 00/10] an introduction of library operating system for Linux (LibOS)
In-Reply-To: <5539F370.9070704@nod.at>
References: <1429263374-57517-1-git-send-email-tazaki@sfc.wide.ad.jp>
	<1429450104-47619-1-git-send-email-tazaki@sfc.wide.ad.jp>
	<5539F370.9070704@nod.at>
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
Content-Type: text/plain; charset=US-ASCII
Sender: owner-linux-mm@kvack.org
List-ID: <linux-mm.kvack.org>
To: richard@nod.at
Cc: linux-arch@vger.kernel.org, arnd@arndb.de, corbet@lwn.net, cl@linux.com, penberg@kernel.org, rientjes@google.com, iamjoonsoo.kim@lge.com, akpm@linux-foundation.org, linux-kernel@vger.kernel.org, linux-doc@vger.kernel.org, netdev@vger.kernel.org, linux-mm@kvack.org, jdike@addtoit.com, rusty@rustcorp.com.au, upa@haeena.net, christoph.paasch@gmail.com, mathieu.lacage@gmail.com, libos-nuse@googlegroups.com


Hi Richard,

At Fri, 24 Apr 2015 09:40:32 +0200,
Richard Weinberger wrote:
> 
> Hi!
> 
> Am 19.04.2015 um 15:28 schrieb Hajime Tazaki:
> > changes from v2:
> > - Patch 02/11 ("slab: add private memory allocator header for arch/lib")
> > * add new allocator named SLIB (Library Allocator): Patch 04/11 is integrated
> >   to 02 (commented by Christoph Lameter)
> > - Overall
> > * rewrite commit log messages
> > 
> > changes from v1:
> > - Patch 01/11 ("sysctl: make some functions unstatic to access by arch/lib"):
> > * add prefix ctl_table_ to newly publiced functions (commented by Joe Perches)
> > - Patch 08/11 ("lib: other kernel glue layer code"):
> > * significantly reduce glue codes (stubs) (commented by Richard Weinberger)
> > - Others
> > * adapt to linux-4.0.0
> > * detect make dependency by Kbuild .cmd files
> 
> I still fail to build it. :-(
> 
> for-asm-upstream-v3 on top of Linus' tree gives:
(snip)
> arch/lib/Makefile:210: recipe for target 'arch/lib/capability.o' failed
> make: *** [arch/lib/capability.o] Error 1

I'm also aware of and already fixed this issue for pre-v4
patch of libos.

> And on top of v4.0 it fails too:
(snip)
> In file included from arch/lib/lib-socket.c:12:0:
> ./include/linux/net.h:216:5: note: declared here
>  int sock_sendmsg(struct socket *sock, struct msghdr *msg, size_t len);
>      ^
> arch/lib/Makefile:210: recipe for target 'arch/lib/lib-socket.o' failed
> make: *** [arch/lib/lib-socket.o] Error 1

since tag v4.0 to libos v3 patch, there is an update on the
sock_sendmsg(): v3 patch already followed the change. that's
why the patch can't build on top of v4.0.

> You *really* need to shape up wrt the build process.

at the moment, the implementation of libos can't automate to
follow such changes in the build process. but good news is
it's a trivial task to follow up the latest function.

my observation on this manual follow up since around 3.7
kernel (2.5 yrs ago) is that these changes mostly happened
during merge-window of each new version, and the fix only
takes a couple of hours at maximum.

I think I can survive with these changes but I'd like to ask
broader opinions.


one more question:

I'd really like to have a suggestion on which tree I should
base for libos tree.

I'm proposing a patchset to arnd/asm-generic tree (which I
believe the base tree for new arch/), while the patchset is
tested with davem/net-next tree because right now libos is
only for net/.

shall I propose a patchset based on Linus' tree instead ?

thank you for your feedback.

-- Hajime

--
To unsubscribe, send a message with 'unsubscribe linux-mm' in
the body to majordomo@kvack.org.  For more info on Linux MM,
see: http://www.linux-mm.org/ .
Don't email: <a href=mailto:"dont@kvack.org"> email@kvack.org </a>
